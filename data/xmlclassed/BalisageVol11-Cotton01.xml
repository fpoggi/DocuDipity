<?xml version="1.0" encoding="UTF-8" standalone="no"?><classedDocument><article xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" class="po-hcontainer e0 e0" version="5.0-subset Balisage-1.3"><title class="po-block e1 e1"><textual class="po-textual">XForms generation: a real world example</textual></title><info class="po-record e2 e2"><confgroup class="po-record e3 e3"><conftitle class="po-field e4 e4"><textual class="po-textual">International Symposium on Native XML User Interfaces</textual></conftitle><confdates class="po-field e5 e5"><textual class="po-textual">August 5, 2013</textual></confdates></confgroup><abstract class="po-container e6 e6"><para class="po-block e7 e7"><textual class="po-textual">INSEE runs a lot of surveys and needs to make them available on different media: paper questionnaires,
                specialized survey software or web forms. As part of an overall effort of rationalization of its
                information system, INSEE recently initiated the construction of a central statistical metadata
                repository and of a generic platform for survey data collection. We describe in this paper a pathfinder
                operation that draws from these two important projects and aims at automating the generation of web
                questionnaires from metadata models. We explain the business justification of this approach and the
                technological choices made, especially the utilization of XForms. The generation process is described in
                detail and the lessons learned from this operation are depicted.</textual></para></abstract><author class="po-record e8 e8"><personname class="po-record e9 e9"><firstname class="po-field e10 e10"><textual class="po-textual">Éric</textual></firstname><surname class="po-field e11 e11"><textual class="po-textual">Sigaud</textual></surname></personname><personblurb class="po-container e12 e12"><para class="po-block e13 e13"><textual class="po-textual">Éric is a project manager at INSEE. He is leading the technical part of the Coltrane project which intends to implement a web collect infrastructure based upon XML technologies
                    and XRX architectures.</textual></para></personblurb><affiliation class="po-record e14 e14"><orgname class="po-block e15 e15"><textual class="po-textual">INSEE</textual></orgname></affiliation></author><author class="po-record e16 e16"><personname class="po-record e17 e17"><firstname class="po-field e18 e18"><textual class="po-textual">Romain</textual></firstname><surname class="po-field e19 e19"><textual class="po-textual">Tailhurat</textual></surname></personname><personblurb class="po-container e20 e20"><para class="po-block e21 e21"><textual class="po-textual">As a member of INSEE's IT architecture division, Romain's job is to support the developers work by providing technical and methodological guidance and tools to enforce the
                    related choices. Romain is also implied in the setting of the new XML development toolkit. And from time to time, he takes pleasure in coding real applications!</textual></para></personblurb><affiliation class="po-record e22 e22"><orgname class="po-block e23 e23"><textual class="po-textual">INSEE</textual></orgname></affiliation></author><author class="po-record e24 e24"><personname class="po-record e25 e25"><firstname class="po-field e26 e26"><textual class="po-textual">Franck</textual></firstname><surname class="po-field e27 e27"><textual class="po-textual">Cotton</textual></surname></personname><personblurb class="po-container e28 e28"><para class="po-block e29 e29"><textual class="po-textual">Franck is a technology evangelist in INSEE, after being successively business statistician, metadata project manager and responsible for IT infrastructure and IT security. He
                    focuses on web standards, especially XML and RDF. He helped organize the uptake of XML development in INSEE and currently spends most of his time promoting the use of metadata
                    standards and linked data technologies in the statistical community.</textual></para></personblurb><affiliation class="po-record e30 e30"><orgname class="po-block e31 e31"><textual class="po-textual">INSEE</textual></orgname></affiliation></author><author class="po-record e32 e32"><personname class="po-record e33 e33"><firstname class="po-field e34 e34"><textual class="po-textual">Éric</textual></firstname><surname class="po-field e35 e35"><textual class="po-textual">van der Vlist</textual></surname></personname><personblurb class="po-container e36 e36"><para class="po-block e37 e37"><textual class="po-textual">Éric is an independent consultant and trainer. His domain of expertise include Web development and XML technologies.</textual></para><para class="po-block e38 e38"><textual class="po-textual">He is the creator and main editor of </textual><link class="po-inline e39 e39" xlink:actuate="onRequest" xlink:href="http://xmlfr.org" xlink:show="new" xlink:type="simple"><textual class="po-textual">XMLfr.org</textual></link><textual class="po-textual">, the main site dedicated to XML technologies in French, the author of the O'Reilly
                    animal books XML Schema and RELAX NG and a member or the ISO DSDL (</textual><link class="po-inline e40 e40" xlink:actuate="onRequest" xlink:href="http://dsdl.org" xlink:show="new" xlink:type="simple"><textual class="po-textual">http://dsdl.org</textual></link><textual class="po-textual">) working group focused on XML schema languages.</textual></para><para class="po-block e41 e41"><textual class="po-textual">He his based in Paris and you can reach him by mail (</textual><link class="po-inline e42 e42" xlink:actuate="onRequest" xlink:href="mailto:vdv@dyomedea.com" xlink:show="new" xlink:type="simple"><textual class="po-textual">vdv@dyomedea.com</textual></link><textual class="po-textual">) or meet him in one of the many conferences where he
                    presents his projects.</textual></para></personblurb><affiliation class="po-record e43 e43"><orgname class="po-block e44 e44"><textual class="po-textual">Dyomedea</textual></orgname></affiliation></author><legalnotice class="po-container e45 e45"><para class="po-block e46 e46"><textual class="po-textual">This work is made available under a Creative Commons Attribution 3.0 License (CC BY 3.0) (</textual><link class="po-inline e47 e47" xlink:actuate="onRequest" xlink:href="http://creativecommons.org/licenses/by/3.0/" xlink:show="new" xlink:type="simple"><textual class="po-textual">http://creativecommons.org/licenses/by/3.0/</textual></link><textual class="po-textual">).</textual></para></legalnotice></info><section class="po-hcontainer e48 e48"><title class="po-block e49 e49"><textual class="po-textual">Context</textual></title><para class="po-block e50 e50"><textual class="po-textual">INSEE (</textual><link class="po-inline e51 e51" xlink:actuate="onRequest" xlink:show="new" xlink:type="simple"><textual class="po-textual">http://www.insee.fr/</textual></link><textual class="po-textual">) is France's National Statistical Institute. Like every statistical organization, it conducts many surveys on households or enterprises. Forms,
            whether on paper or electronic, are therefore key business objects.</textual></para><para class="po-block e52 e52"><textual class="po-textual">For a long time, forms have been designed and managed independently and in a rather </textual><emphasis class="po-inline e53 e53"><textual class="po-textual">ad hoc</textual></emphasis><textual class="po-textual"> fashion, but today statistical offices face new challenges (growing
            demand, data deluge, resource constraints, etc., see </textual><xref class="po-milestone e54 e54" linkend="hlg-vision"><textual class="po-textual">Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao</textual></xref><textual class="po-textual">) that urge them to rationalize and industrialize all their business processes.</textual></para><para class="po-block e55 e55"><textual class="po-textual">In the case of survey forms, or data acquisition in general, we also have to adapt to a growing diversification in the modes of collection: paper, telephone, various web devices,
            etc.</textual></para><para class="po-block e56 e56"><textual class="po-textual">How should we organize the data collection processes to adapt to this new situation? The statistical community has identified some principles to guide the work in that respect:</textual></para><itemizedlist class="po-table e57 e57"><listitem class="po-container e58 e58"><para class="po-block e59 e59"><textual class="po-textual">rely on standard and shared definitions for the concepts measured, codification, etc.</textual></para></listitem><listitem class="po-container e60 e60"><para class="po-block e61 e61"><textual class="po-textual">share questions or question blocs across surveys</textual></para></listitem><listitem class="po-container e62 e62"><para class="po-block e63 e63"><textual class="po-textual">automate the production of the forms, and the retrieval of response data</textual></para></listitem></itemizedlist><para class="po-block e64 e64"><textual class="po-textual">This paper describes the application of these ideas to the generation of XForms questionnaires for a real business survey (</textual><xref class="po-milestone e65 e65" linkend="cis"><textual class="po-textual">Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao</textual></xref><textual class="po-textual">). We first explain in greater detail the
            motivations and the design choices made, then we give the details of the techniques employed. As a conclusion, we present some of the lessons learned from this operation and evoke some
            future directions.</textual></para></section><section class="po-hcontainer e66 e66"><title class="po-block e67 e67"><textual class="po-textual">The case for generating XForms</textual></title><section class="po-hcontainer e68 e68"><title class="po-block e69 e69"><textual class="po-textual">The need of a model</textual></title><para class="po-block e70 e70"><textual class="po-textual">In this perspective of rationalization of its business process, INSEE launched a number of projects, two of which are of particular importance for the subject treated here:</textual></para><itemizedlist class="po-table e71 e71"><listitem class="po-container e72 e72"><para class="po-block e73 e73"><emphasis class="po-inline e74 e74"><textual class="po-textual">RMéS</textual></emphasis><textual class="po-textual">
                        </textual><footnote class="po-popup e75 e75"><para class="po-block e76 e76"><textual class="po-textual">Référentiel de métadonnées statistiques</textual></para></footnote><textual class="po-textual"> aims to build a central management system for statistical metadata</textual></para></listitem><listitem class="po-container e77 e77"><para class="po-block e78 e78"><emphasis class="po-inline e79 e79"><textual class="po-textual">Coltrane</textual></emphasis><textual class="po-textual">
                        </textual><footnote class="po-popup e80 e80"><para class="po-block e81 e81"><textual class="po-textual">Collecte transversale d'enquêtes</textual></para></footnote><textual class="po-textual">, whose goal is to build a unified infrastructure for survey data collection</textual></para></listitem></itemizedlist><para class="po-block e82 e82"><textual class="po-textual">The operation described in the present paper sits at the crossroads between these two projects, and it has been conducted as a collaboration of the two project teams.</textual></para><para class="po-block e83 e83"><textual class="po-textual">The Coltrane project aims to industrialize the collection processes in a variety of domains like contact management or authentication methods, but one of its primary objectives is to
                build a single platform for collecting survey data, which would replace the different systems in use today. This platform needs to be able to collect data in different ways, even
                within the same survey:</textual></para><para class="po-block e84 e84"><textual class="po-textual">
                </textual><itemizedlist class="po-table e85 e85"><listitem class="po-container e86 e86"><para class="po-block e87 e87"><textual class="po-textual">with paper questionnaires sent by mail</textual></para></listitem><listitem class="po-container e88 e88"><para class="po-block e89 e89"><textual class="po-textual">with web forms or electronic documents (PDF, ODF </textual><footnote class="po-popup e90 e90"><para class="po-block e91 e91"><textual class="po-textual">Open Document Format for Office Applications (</textual><link class="po-inline e92 e92" xlink:actuate="onRequest" xlink:show="new" xlink:type="simple"><textual class="po-textual">http://en.wikipedia.org/wiki/OpenDocument</textual></link><textual class="po-textual">)</textual></para></footnote><textual class="po-textual">, etc.)</textual></para></listitem><listitem class="po-container e93 e93"><para class="po-block e94 e94"><textual class="po-textual">with specialized software packages like Blaise </textual><footnote class="po-popup e95 e95"><para class="po-block e96 e96"><textual class="po-textual">See </textual><link class="po-inline e97 e97" xlink:actuate="onRequest" xlink:show="new" xlink:type="simple"><textual class="po-textual">http://www.blaise.com/</textual></link><textual class="po-textual">.</textual></para></footnote><textual class="po-textual">, which is the one used at INSEE</textual></para></listitem></itemizedlist><textual class="po-textual">
            </textual></para><para class="po-block e98 e98"><textual class="po-textual">This requirement leads naturally to the idea of creating these different manifestations of a given questionnaire from a common representation of the content and the logic flow, in
                the most automated fashion possible. This common representation is in fact based on metadata.</textual></para><para class="po-block e99 e99"><textual class="po-textual">Statistical metadata come in different kinds: concept schemes, code lists and classifications, but also quality or methodological metadata, process descriptions, etc. The
                availability of harmonized and good-quality metadata has been identified as a major factor of progress for statistical offices.</textual></para><para class="po-block e100 e100"><textual class="po-textual">Since metadata provide for the structuring and documentation of the statistical data, we need metadata standardization in order to be able to understand and compare data or to make
                them interoperable. Different standards exist on the international level for statistical metadata, for example SDMX </textual><footnote class="po-popup e101 e101"><para class="po-block e102 e102"><textual class="po-textual">Statistical Data and Metadata Exchange</textual></para></footnote><textual class="po-textual"> (</textual><xref class="po-milestone e103 e103" linkend="sdmx"><textual class="po-textual">Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao</textual></xref><textual class="po-textual">), an ISO standard focused on the exchange of dimensional data (tables, cubes...) and associated metadata, the Neuchâtel Model (</textual><xref class="po-milestone e104 e104" linkend="neuchatel"><textual class="po-textual">Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao</textual></xref><textual class="po-textual">), a </textual><emphasis class="po-inline e105 e105"><textual class="po-textual">de facto</textual></emphasis><textual class="po-textual"> standard representation of statistical classifications or the GSBPM </textual><footnote class="po-popup e106 e106"><para class="po-block e107 e107"><textual class="po-textual">Generic Statistical Business Process Model</textual></para></footnote><textual class="po-textual"> (</textual><xref class="po-milestone e108 e108" linkend="gsbpm"><textual class="po-textual">Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao</textual></xref><textual class="po-textual">), a common high-level representation of the statistical process.</textual></para><para class="po-block e109 e109"><textual class="po-textual">An important goal of the RMéS project is to align INSEE's metadata models on international standards.
                But storing or even managing metadata is not enough: we know from experience that metadata is not used
                when it is just after-the-fact documentation, for example because the informations are not up-to-date.
                What is expected from the RMéS project is the emergence of a metadata-driven information system, in
                which the meta-information is actively leveraged in the production process. This means that we build on
                these metadata: for example a code list generates controls in a data editing activity, or a
                questionnaire description in a specific meta-model is used to produce the actual survey
                instrument.</textual></para><para class="po-block e110 e110"><textual class="po-textual">We see that Coltrane and RMéS have a convergent interest: the automatic generation of collection instruments from standard metadata-based models of questionnaires.</textual></para><figure class="po-container e111 e111"><title class="po-block e112 e112"><textual class="po-textual">Generation of collection instruments</textual></title><mediaobject class="po-container e113 e113"><imageobject class="po-container e114 e114"><imagedata class="po-meta e115 e115" fileref="../../../vol11/graphics/Cotton01/Cotton01-001.png"><textual class="po-textual">Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao</textual></imagedata></imageobject></mediaobject></figure><para class="po-block e116 e116"><textual class="po-textual">The studies carried out by both projects concluded that DDI </textual><footnote class="po-popup e117 e117"><para class="po-block e118 e118"><textual class="po-textual">Data Documentation Initiative (</textual><link class="po-inline e119 e119" xlink:actuate="onRequest" xlink:show="new" xlink:type="simple"><textual class="po-textual">http://www.ddialliance.org/</textual></link><textual class="po-textual">)</textual></para></footnote><textual class="po-textual"> was the best metadata standard to use for their common purpose.</textual></para><para class="po-block e120 e120"><textual class="po-textual">DDI is </textual><quote class="po-inline e121 e121"><textual class="po-textual">an international standard for describing data from the social, behavioral, and economic sciences</textual></quote><textual class="po-textual"> (</textual><link class="po-inline e122 e122" xlink:actuate="onRequest" xlink:show="new" xlink:type="simple"><textual class="po-textual">http://www.ddialliance.org/what</textual></link><textual class="po-textual">). It is a
                well-established standard for researchers and data archives, and its “Lifecycle” version (</textual><xref class="po-milestone e123 e123" linkend="ddi32"><textual class="po-textual">Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao</textual></xref><textual class="po-textual">) has more recently attracted attention within the official statistics
                community.</textual></para><para class="po-block e124 e124"><textual class="po-textual">As shown in the following picture, DDI is based on a model of the whole data and metadata lifecycle during the statistical production process and provides – by design –
                the possibility to convey business information all along this process.</textual></para><figure class="po-container e125 e125"><title class="po-block e126 e126"><textual class="po-textual">The statistical process in DDI-Lifecycle</textual></title><mediaobject class="po-container e127 e127"><imageobject class="po-container e128 e128"><imagedata class="po-meta e129 e129" fileref="../../../vol11/graphics/Cotton01/Cotton01-002.png"><textual class="po-textual">Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao</textual></imagedata></imageobject><caption class="po-container e130 e130"><para class="po-block e131 e131"><textual class="po-textual">Copyright © 2013, DDI Alliance</textual></para></caption></mediaobject></figure><para class="po-block e132 e132"><textual class="po-textual">DDI's “Data collection” module delivers great support for describing survey instruments, in particular questionnaires, with their structure and logical flow. This explains the choice
                made by the two projects, with RMéS focusing on the elaboration of the DDI models and Coltrane on the generation of the survey instruments.</textual></para></section><section class="po-hcontainer e133 e133"><title class="po-block e134 e134"><textual class="po-textual">Why XForms?</textual></title><para class="po-block e135 e135"><textual class="po-textual">The different ways to administer a questionnaire do not have the same possibilities. Except for visual presentation, paper forms have rather poor functionalities, 
                but but statistical offices have long since developed processes that allow them to be used efficiently. Software packages like Blaise are highly specialized and can easily handle complex content or logic,
                with rich interfaces for exchanging data. In both cases, business objectives are fulfilled, either through the organization or the software features. Web forms or electronic documents,
                on the other hand, leverage powerful and versatile technologies that must be tailored to the business needs.</textual></para><para class="po-block e136 e136"><textual class="po-textual">In order to take the full advantage of web forms, the following requirements were selected:</textual></para><para class="po-block e137 e137"><textual class="po-textual">
                </textual><itemizedlist class="po-table e138 e138"><listitem class="po-container e139 e139"><para class="po-block e140 e140"><textual class="po-textual">The possibility to implement the logical flow of the questionnaire</textual></para></listitem><listitem class="po-container e141 e141"><para class="po-block e142 e142"><textual class="po-textual">The possibility to formalize and execute controls on the client or server side</textual></para></listitem><listitem class="po-container e143 e143"><para class="po-block e144 e144"><textual class="po-textual">The possibility to inject initialization data (for example for questionnaire personalization)</textual></para></listitem><listitem class="po-container e145 e145"><para class="po-block e146 e146"><textual class="po-textual">The possibility to produce different variants of a questionnaire depending on the respondent</textual></para></listitem><listitem class="po-container e147 e147"><para class="po-block e148 e148"><textual class="po-textual">The possibility to easily retrieve the response data</textual></para></listitem><listitem class="po-container e149 e149"><para class="po-block e150 e150"><textual class="po-textual">The possibility to style user interface elements according to business characteristics of the underlying questionnaire</textual></para></listitem></itemizedlist><textual class="po-textual">
            </textual></para><para class="po-block e151 e151"><textual class="po-textual">These requirements combine some aspects that are defined in the abstract model and others that depend on the web implementation chosen, so we felt that we needed an intermediary
                technical model suited for the web, allowing us a step for processing and additional fine-tuning operations on the final questionnaire. We chose to express this technical model in
                XForms.</textual></para><para class="po-block e152 e152"><textual class="po-textual">XForms is a powerful tool for the distribution of complex forms over the Internet. First of all, its design offers an easy way to initialize and capture data and to support complex
                dynamic treatments through its Model-View-Controller architecture.</textual></para><para class="po-block e153 e153"><textual class="po-textual">Another decisive aspect of our choice is that XForms is the first X of the XRX architecture. XRX is XForms-REST-XQuery
                    [</textual><link class="po-inline e154 e154" xlink:actuate="onRequest" xlink:show="new" xlink:type="simple"><textual class="po-textual">http://en.wikipedia.org/wiki/XRX_(web_application_architecture)</textual></link><textual class="po-textual">], an elegant software architecture which, amongst others, promotes a zero-impedance model in which
                data and code are members of the XML family, thus providing a coherent set of technologies. Since DDI is also expressed as XML schemas, we had the opportunity to build a completely
                homogenous solution.</textual></para><para class="po-block e155 e155"><textual class="po-textual">Finally, the XForms implementations offer both client-side and server-side execution: hence we can imagine different balances of both depending on needs.</textual></para><para class="po-block e156 e156"><textual class="po-textual">As to the last requirement above, it is easy to include in the XForms technical model some CSS references depending on the underlying questionnaire model.</textual></para><para class="po-block e157 e157"><textual class="po-textual">Our web forms generation pipeline now looks like this:</textual></para><figure class="po-container e158 e158"><title class="po-block e159 e159"><textual class="po-textual">Generation of web forms – principle</textual></title><mediaobject class="po-container e160 e160"><imageobject class="po-container e161 e161"><imagedata class="po-meta e162 e162" fileref="../../../vol11/graphics/Cotton01/Cotton01-003.png"><textual class="po-textual">Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao</textual></imagedata></imageobject></mediaobject></figure><para class="po-block e163 e163"><textual class="po-textual">It is worth noting that although XForms provides a great solution for complex web forms, it is a generic design format and so misses information relevant to our activity. It would
                not be adequate to use the XForms meta model to store our business information: we need a specific model through which we could express our core domain activity, and store and reuse
                components. XForms is envisioned as a target model, not a source model.</textual></para><para class="po-block e164 e164"><textual class="po-textual">While our primary motivation to generate XForms rather than manually edit them has been the need of a generic model, we've found out that this process is a good workaround against
                two XForms weaknesses:</textual><itemizedlist class="po-table e165 e165"><listitem class="po-container e166 e166"><para class="po-block e167 e167"><textual class="po-textual">XForms is based on a pure MVC paradigm which can be an issue when controls or groups of controls are repeated in different contexts in the same form or in different forms
                            (see Eric van der Vlist's “</textual><link class="po-inline e168 e168" xlink:actuate="onRequest" xlink:href="http://eric.van-der-vlist.com/blog/2013/03/06/when-mvc-becomes-a-burden-for-xforms/" xlink:show="new" xlink:type="simple"><textual class="po-textual">When MVC becomes a burden for
                                XForms</textual></link><textual class="po-textual">”). When editing XForms by hand this leads to a number of “copy &amp; paste” which become a nightmare to maintain. When generating XForms these repetitions
                            are not an issue any longer.</textual></para></listitem><listitem class="po-container e169 e169"><para class="po-block e170 e170"><textual class="po-textual">The current version of XForms (XForms 1.1) is limited and the use of non standard extensions is often necessary to perform complex tasks. These extensions are
                            implementation dependent and non interoperable. When generating XForms from a model, these differences can be seen as minor templates adaptations.</textual></para></listitem></itemizedlist><textual class="po-textual">
            </textual></para><para class="po-block e171 e171"><textual class="po-textual">We see from this last point that the XForms generation process must be easily adaptable to the target implementation. This idea is at the heart of our generic transformation
                engine.</textual></para></section></section><section class="po-hcontainer e172 e172"><title class="po-block e173 e173"><textual class="po-textual">Technical description</textual></title><para class="po-block e174 e174"><textual class="po-textual">The next figure shows the technologies chosen to implement the generation process described in the previous section.</textual></para><figure class="po-container e175 e175"><title class="po-block e176 e176"><textual class="po-textual">Generation of web forms – technologies</textual></title><mediaobject class="po-container e177 e177"><imageobject class="po-container e178 e178"><imagedata class="po-meta e179 e179" fileref="../../../vol11/graphics/Cotton01/Cotton01-004.png"><textual class="po-textual">Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao</textual></imagedata></imageobject></mediaobject></figure><para class="po-block e180 e180"><textual class="po-textual">For the first transformation chain, the input is a questionnaire specification expressed in the DDI XML metamodel and the output is an XHTML5 + XForms document representing the final
            web form.</textual></para><para class="po-block e181 e181"><textual class="po-textual">Since we were transforming XML documents into XML documents, XSLT was of course the natural choice. The functional approach and template-matching design of XSLT correspond very well with
            our intent to attach a specific web representation to each of our questionnaire metadata (questions, data to collect, instructions). We thus designed a base transformation engine using
            chained XSLT stylesheets.</textual></para><para class="po-block e182 e182"><textual class="po-textual">A notable challenge was to cope with the complexity of the DDI metamodel, which maximizes the reusability of metadata elements like questions, code lists, or even texts, and also
            implements a very detailed versioning mechanism. As a consequence, DDI documents use a lot of chained references to bind logical elements together, and can be quite complex and difficult
            to process with XSLT which is more efficient with hierarchical document architecture than with relational structures.</textual></para><para class="po-block e183 e183"><textual class="po-textual">Therefore, it was easier to design a series of separate steps producing simpler intermediate formats of the inputs or outputs, instead of a big and complex transformation.</textual></para><para class="po-block e184 e184"><textual class="po-textual">The first step is a DDI compilation, resolving all references and providing a hierarchical view of the metadata. Then DDI elements are matched with generic behaviours, as TextInput (to
            figure a field designed to collect text), NumericInput, and so on. This is what we called the input steps. In the output steps, the behaviours are implemented to generate XForms components
            on the fly. At the end, finalization transformations are used to reorganize the outputs and render well-formed XForms documents.</textual></para><para class="po-block e185 e185"><textual class="po-textual">The overall scripting of the XSLT chain was done with Ant, mainly because it is our corporate standard. For a next version of the engine, we are considering using XProc.</textual></para><para class="po-block e186 e186"><textual class="po-textual">We've seen that DDI models are focused on describing data rather than surveys (you will not find, for
            example, any information in DDI to say if a data should be entered by a drop down menu or check boxes). DDI
            includes extension mechanisms which can be used to convey information which can be used to generate surveys
            but we prefer to rely on conventions to drive the transformation. In practice these conventions are project
            dependent and you need to add customization features to the XSLT engine to ensure its flexibility.</textual></para><para class="po-block e187 e187"><textual class="po-textual">We added customization stylesheets using xsl:import (as often and in accord with the design patterns on overloading). In order to ensure quality and maintainability of our XSLT code, a
            careful design of the granularity and naming conventions was required. We defined default behaviours – implemented in the default engine – and customized behaviours attached
            to questionnaire elements – implemented in the customization stylesheets – when customized representations were needed.</textual></para><para class="po-block e188 e188"><textual class="po-textual">We chose to specify these customized behaviours with spreadsheets, and more specifically ODF spreadsheets (ODS files), thereby preserving the XML homogeneity of our solution. The XML
            root structure of these spreadsheets is used as XML input of “configuration XSLT transformations” which produce the XSLT customization stylesheets (which, themselves, override some of the
            default behaviours of the default engine during the transformation to XHTML5 + XForms).</textual></para><figure class="po-container e189 e189"><title class="po-block e190 e190"><textual class="po-textual">Generation of web forms – specification</textual></title><mediaobject class="po-container e191 e191"><imageobject class="po-container e192 e192"><imagedata class="po-meta e193 e193" fileref="../../../vol11/graphics/Cotton01/Cotton01-005.png"><textual class="po-textual">Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao</textual></imagedata></imageobject></mediaobject></figure><para class="po-block e194 e194"><textual class="po-textual">This “spreadsheet-driven architecture” permits business experts to customize their questionnaires themselves with tools that they master, without knowing anything about XSLT. At this point,
            they still need to be somewhat comfortable with the DDI XML metamodel, but we're considering providing a guided interface to reduce, as much as possible, the technical IT requirements to design
            questionnaires.</textual></para></section><section class="po-hcontainer e195 e195"><title class="po-block e196 e196"><textual class="po-textual">Lessons learned</textual></title><para class="po-block e197 e197"><textual class="po-textual">Our first goal was to be able to generate questionnaires using metadata definitions. It was not obvious for us that with a metamodel handling only statistical semantics we would be
            able to automatically generate all the features needed by our questionnaires. Moreover, we were not sure that DDI would support all these features. So, first of all, this realization is a
            good proof of concept for us, proof of technical feasibility to drive questionnaire generation with metadata. A concrete example of metadata-driven architecture for INSEE and the official
            statistics community.</textual></para><para class="po-block e198 e198"><textual class="po-textual">Our goal to design a generic engine to industrialize the production of forms customized by domain experts has been really challenging and led us to define XSLT design patterns such as:</textual><itemizedlist class="po-table e199 e199"><listitem class="po-container e200 e200"><para class="po-block e201 e201"><textual class="po-textual">Use </textual><code class="po-atom e202 e202"><textual class="po-textual">xsl:apply-templates</textual></code><textual class="po-textual">/</textual><code class="po-atom e203 e203"><textual class="po-textual">xsl:template</textual></code><textual class="po-textual"> rather than </textual><code class="po-atom e204 e204"><textual class="po-textual">xsl:choose</textual></code><textual class="po-textual"> as much as possible.</textual></para></listitem><listitem class="po-container e205 e205"><para class="po-block e206 e206"><textual class="po-textual">Decouple templates and functions related to the source documents from those in charge of the output tree generation.</textual></para></listitem><listitem class="po-container e207 e207"><para class="po-block e208 e208"><textual class="po-textual">Implement the “spreadsheet-driven mechanism” using a functional programming paradigm inspired by </textual><link class="po-inline e209 e209" xlink:actuate="onRequest" xlink:href="http://fxsl.sourceforge.net/" xlink:show="new" xlink:type="simple"><textual class="po-textual">Dimitre Novatchev's
                            FXSL</textual></link><textual class="po-textual"> (we've ruled out XSLT 3.0 features until they are more commonly implemented).</textual></para></listitem></itemizedlist><textual class="po-textual">
        </textual></para><para class="po-block e210 e210"><textual class="po-textual">The first bullet point is one of the basics of sane XSLT programming but the two others – which are
            closely related – go against common XSLT programming. </textual></para><para class="po-block e211 e211"><textual class="po-textual">To write or even just to read and understand most XSLT transformation one must understand three different
            domain specific vocabularies:</textual><itemizedlist class="po-table e212 e212"><listitem class="po-container e213 e213"><para class="po-block e214 e214"><textual class="po-textual">XSLT and XPath themselves</textual></para></listitem><listitem class="po-container e215 e215"><para class="po-block e216 e216"><textual class="po-textual">The knowledge of the vocabulary used by the source document is required to understand most
                        XPath expressions</textual></para></listitem><listitem class="po-container e217 e217"><para class="po-block e218 e218"><textual class="po-textual">The knowledge of the vocabulary used by the result document is necessary to understand the
                        production of literals and the general structure of the transformation.</textual></para></listitem></itemizedlist></para><para class="po-block e219 e219"><textual class="po-textual">For this project the team was spread over multiple departments, profiles and geographical locations and
            composed of:</textual><itemizedlist class="po-table e220 e220"><listitem class="po-container e221 e221"><para class="po-block e222 e222"><textual class="po-textual">Business experts whose job is to design surveys and DDI experts who create the DDI model for
                        these surveys</textual></para></listitem><listitem class="po-container e223 e223"><para class="po-block e224 e224"><textual class="po-textual">XSLT developers who speak fluently DDI and have a basic knowledge of XForms</textual></para></listitem><listitem class="po-container e225 e225"><para class="po-block e226 e226"><textual class="po-textual">XForms experts who are also fluent XSLT developers but are puzzled by the complexity of
                        DDI.</textual></para></listitem></itemizedlist></para><para class="po-block e227 e227"><textual class="po-textual">The use of spreadsheets to generate XSLT templates has been a first step in the separation of concerns
            between design and implementation and we've gone a step further and separated as much as possible the
            concerns between DDI and XForms expertise so that in this loosely coupled team each profile could work as
            independently as possible.</textual></para><para class="po-block e228 e228"><textual class="po-textual">This second step has been achieved by defining, like we would have done in any other programming language,
            an </textual><link class="po-inline e229 e229" xlink:actuate="onRequest" xlink:href="http://en.wikipedia.org/wiki/Interface_%28computer_science%29" xlink:show="new" xlink:type="simple"><textual class="po-textual">interface</textual></link><textual class="po-textual"> between
            everything related to DDI and anything related to XForms, the challenge being to define how this interface
            should be organized to take advantage of the template oriented nature of XSLT while performing this
            separation of concerns between source and result vocabularies.</textual></para><para class="po-block e230 e230"><textual class="po-textual">The separation of concerns being materialized by splitting XSLT stylesheets between anything related to
            the source document and anything related to the result tree, the source related templates which are
            generated from the spreadsheet build a dynamic document, called the "driver" because its role is to drive
            the generation of the result tree and apply the templates on driver's nodes.</textual></para><para class="po-block e231 e231"><textual class="po-textual">Result oriented templates match driver nodes to create the result tree and use a set of accessors
            functions implemented by the source oriented stylesheets to get any additional info they may need. An
            additional interface function implemented by source stylesheets returns the nodeset considered as the
            logical children of the context node from the source document. </textual></para><para class="po-block e232 e232"><textual class="po-textual">This can be seen as a dialog between source and result stylesheets:</textual><itemizedlist class="po-table e233 e233"><listitem class="po-container e234 e234"><para class="po-block e235 e235"><emphasis class="po-inline e236 e236" role="bold"><textual class="po-textual">Source</textual></emphasis><textual class="po-textual">: Hmmm, my context node should be translated into this
                        XForms control. I append the element identifying this control to the driver and apply the
                        templates in result mode on this element in the driver.</textual></para></listitem><listitem class="po-container e237 e237"><para class="po-block e238 e238"><emphasis class="po-inline e239 e239" role="bold"><textual class="po-textual">Result</textual></emphasis><textual class="po-textual">: I see in the driver that I need to generate this
                        XForms control. Please give me (using accessor functions) these information.</textual></para></listitem><listitem class="po-container e240 e240"><para class="po-block e241 e241"><emphasis class="po-inline e242 e242" role="bold"><textual class="po-textual">Result</textual></emphasis><textual class="po-textual">: I am done with this control, tell me which are the
                        logical children of your context node so that I can apply the templates in source mode on these
                        children.</textual></para></listitem></itemizedlist></para><para class="po-block e243 e243"><textual class="po-textual">We have found this design pattern very effective during our implementation.</textual></para><para class="po-block e244 e244"><textual class="po-textual">To develop the result stylesheets which generate Orbeon Form Builder forms, we've written a set of source
            stylesheets implementing this interface on source documents which are... Form Builder forms! The combination
            gave us an identity transformation which has been very handy to debug the result stylesheets.</textual></para><para class="po-block e245 e245"><textual class="po-textual">Different flavors of the result stylesheets are also being developed to generate "pure" XForms forms for
            different implementations (Orbeon, XSLTForms and betterFORM) and this separation of concerns greatly
            facilitates this development. The main difficulties met so far are related to the lack of interoperability
            of the different XForms implementations.</textual></para><para class="po-block e246 e246"><textual class="po-textual">The deployment of a first survey in production on Orbeon Form Runner has not shown any performance issue
            despite the size of the form (15,000 lines, 10,000 elements, 1.1 Mo).</textual></para><para class="po-block e247 e247"><textual class="po-textual">The development described in this paper has validated our approach of generating surveys instruments from
            questionnaire descriptions. This approach had previously been applied to the generation of electronic
            documents (ODF), but targeting XForms led us to a much more flexible and configurable solution. We now
            envision with confidence the possibility of generating entirely new formats like Blaise.</textual></para></section><bibliography class="po-hcontainer e248 e248"><title class="po-block e249 e249"><textual class="po-textual">Bibliography</textual></title><bibliomixed class="po-block e250 e250" xml:id="hlg-vision" xreflabel="HLG-BAS Vision"><textual class="po-textual">UNECE, </textual><quote class="po-inline e251 e251"><textual class="po-textual">Strategic vision of the High-Level Group for the Modernisation of Statistical Production and Services</textual></quote><textual class="po-textual">,
                </textual><link class="po-inline e252 e252" xlink:actuate="onRequest" xlink:show="new" xlink:type="simple"><textual class="po-textual">http://www1.unece.org/stat/platform/display/hlgbas/Strategic+vision+of+the+HLG</textual></link></bibliomixed><bibliomixed class="po-block e253 e253" xml:id="cis" xreflabel="CIS"><textual class="po-textual">CIS, </textual><quote class="po-inline e254 e254"><textual class="po-textual">Community Innovation Statistics</textual></quote><textual class="po-textual">. </textual><link class="po-inline e255 e255" xlink:actuate="onRequest" xlink:show="new" xlink:type="simple"><textual class="po-textual">http://epp.eurostat.ec.europa.eu/portal/page/portal/microdata/cis</textual></link></bibliomixed><bibliomixed class="po-block e256 e256" xml:id="ddi32" xreflabel="DDI 3.2"><textual class="po-textual">DDI Alliance, </textual><quote class="po-inline e257 e257"><textual class="po-textual">DDI 3.2 (Public Review Version)</textual></quote><textual class="po-textual">.
            </textual><link class="po-inline e258 e258" xlink:actuate="onRequest" xlink:show="new" xlink:type="simple"><textual class="po-textual">http://www.ddialliance.org/Specification/DDI-Lifecycle/3.2/</textual></link></bibliomixed><bibliomixed class="po-block e259 e259" xml:id="sdmx" xreflabel="SDMX"><textual class="po-textual">SDMX Sponsors, </textual><quote class="po-inline e260 e260"><textual class="po-textual">Statistical Data and Metadata Exchange</textual></quote><textual class="po-textual">, </textual><link class="po-inline e261 e261" xlink:actuate="onRequest" xlink:show="new" xlink:type="simple"><textual class="po-textual">http://sdmx.org/</textual></link></bibliomixed><bibliomixed class="po-block e262 e262" xml:id="neuchatel" xreflabel="NEUCHATEL"><textual class="po-textual">UNECE, </textual><quote class="po-inline e263 e263"><textual class="po-textual">Neuchâtel Terminology Model for classifications</textual></quote><textual class="po-textual">,
                </textual><link class="po-inline e264 e264" xlink:actuate="onRequest" xlink:show="new" xlink:type="simple"><textual class="po-textual">http://www1.unece.org/stat/platform/pages/viewpage.action?pageId=14319930</textual></link></bibliomixed><bibliomixed class="po-block e265 e265" xml:id="gsbpm" xreflabel="GSBPM"><textual class="po-textual">UNECE, </textual><quote class="po-inline e266 e266"><textual class="po-textual">The Generic Statistical Business Process Model</textual></quote><textual class="po-textual">,
                </textual><link class="po-inline e267 e267" xlink:actuate="onRequest" xlink:show="new" xlink:type="simple"><textual class="po-textual">http://www1.unece.org/stat/platform/display/metis/The+Generic+Statistical+Business+Process+Model</textual></link></bibliomixed></bibliography></article></classedDocument>