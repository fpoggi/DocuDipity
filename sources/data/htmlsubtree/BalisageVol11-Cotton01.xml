<div id="mainContainerTOC">
   <div id="mainContainerTitleTOC" onclick="$('#mainContainerEntriesTOC').toggle('1000');">Table of Content</div>
   <div id="mainContainerEntriesTOC" style="display:none;">
      <div class="headedContainerTOC">
         <div class="headedContainerTitleTOC"><a href="#XFormsgeneration:arealworldexampleANCHOR" name="XFormsgeneration:arealworldexampleTOC">XForms generation: a real world example</a></div>
         <div class="headedContainerTOC">
            <div class="headedContainerTitleTOC"><a href="#ContextANCHOR" name="ContextTOC">Context</a></div>
         </div>
         <div class="headedContainerTOC">
            <div class="headedContainerTitleTOC"><a href="#ThecaseforgeneratingXFormsANCHOR" name="ThecaseforgeneratingXFormsTOC">The case for generating XForms</a></div>
            <div class="headedContainerTOC">
               <div class="headedContainerTitleTOC"><a href="#TheneedofamodelANCHOR" name="TheneedofamodelTOC">The need of a model</a></div>
            </div>
            <div class="headedContainerTOC">
               <div class="headedContainerTitleTOC"><a href="#WhyXForms?ANCHOR" name="WhyXForms?TOC">Why XForms?</a></div>
            </div>
         </div>
         <div class="headedContainerTOC">
            <div class="headedContainerTitleTOC"><a href="#TechnicaldescriptionANCHOR" name="TechnicaldescriptionTOC">Technical description</a></div>
         </div>
         <div class="headedContainerTOC">
            <div class="headedContainerTitleTOC"><a href="#LessonslearnedANCHOR" name="LessonslearnedTOC">Lessons learned</a></div>
         </div>
         <div class="headedContainerTOC">
            <div class="headedContainerTitleTOC"><a href="#BibliographyANCHOR" name="BibliographyTOC">Bibliography</a></div>
         </div>
      </div>
   </div>
</div>
<div id="mainContainerTERMS">
   <div id="mainContainerTitleTERMS" onclick="$('#mainContainerEntriesTERMS').toggle('1000')">Index of Terms</div>
   <div id="mainContainerEntriesTERMS" style="display:none;">
      <div class="letterContainerTERMS">
         <div class="letterlableTERMS">a</div>
         <div class="singletermTERMS">ad hoc</div>
         <div class="singletermTERMS">August 5, 2013</div>
      </div>
      <div class="letterContainerTERMS">
         <div class="letterlableTERMS">b</div>
      </div>
      <div class="letterContainerTERMS">
         <div class="letterlableTERMS">c</div>
         <div class="singletermTERMS">Community Innovation Statistics</div>
         <div class="singletermTERMS">Coltrane</div>
         <div class="singletermTERMS">Cotton</div>
      </div>
      <div class="letterContainerTERMS">
         <div class="letterlableTERMS">d</div>
         <div class="singletermTERMS">Dimitre Novatchev's FXSL</div>
         <div class="singletermTERMS">DDI 3.2 (Public Review Version)</div>
         <div class="singletermTERMS">de facto</div>
      </div>
      <div class="letterContainerTERMS">
         <div class="letterlableTERMS">e</div>
      </div>
      <div class="letterContainerTERMS">
         <div class="letterlableTERMS">f</div>
         <div class="singletermTERMS">Franck</div>
      </div>
      <div class="letterContainerTERMS">
         <div class="letterlableTERMS">g</div>
      </div>
      <div class="letterContainerTERMS">
         <div class="letterlableTERMS">h</div>
      </div>
      <div class="letterContainerTERMS">
         <div class="letterlableTERMS">i</div>
         <div class="singletermTERMS">interface</div>
      </div>
      <div class="letterContainerTERMS">
         <div class="letterlableTERMS">j</div>
      </div>
      <div class="letterContainerTERMS">
         <div class="letterlableTERMS">k</div>
      </div>
      <div class="letterContainerTERMS">
         <div class="letterlableTERMS">l</div>
      </div>
      <div class="letterContainerTERMS">
         <div class="letterlableTERMS">m</div>
      </div>
      <div class="letterContainerTERMS">
         <div class="letterlableTERMS">n</div>
         <div class="singletermTERMS">Neuchâtel Terminology Model for classifications</div>
      </div>
      <div class="letterContainerTERMS">
         <div class="letterlableTERMS">o</div>
      </div>
      <div class="letterContainerTERMS">
         <div class="letterlableTERMS">p</div>
      </div>
      <div class="letterContainerTERMS">
         <div class="letterlableTERMS">q</div>
      </div>
      <div class="letterContainerTERMS">
         <div class="letterlableTERMS">r</div>
         <div class="singletermTERMS">RMéS</div>
         <div class="singletermTERMS">Result</div>
         <div class="singletermTERMS">Romain</div>
      </div>
      <div class="letterContainerTERMS">
         <div class="letterlableTERMS">s</div>
         <div class="singletermTERMS">Statistical Data and Metadata Exchange</div>
         <div class="singletermTERMS">Source</div>
         <div class="singletermTERMS">Sigaud</div>
      </div>
      <div class="letterContainerTERMS">
         <div class="letterlableTERMS">t</div>
         <div class="singletermTERMS">The Generic Statistical Business Process Model</div>
         <div class="singletermTERMS">Tailhurat</div>
      </div>
      <div class="letterContainerTERMS">
         <div class="letterlableTERMS">u</div>
      </div>
      <div class="letterContainerTERMS">
         <div class="letterlableTERMS">v</div>
         <div class="singletermTERMS">vdv@dyomedea.com</div>
         <div class="singletermTERMS">van der Vlist</div>
      </div>
      <div class="letterContainerTERMS">
         <div class="letterlableTERMS">x</div>
         <div class="singletermTERMS">xsl:apply-templates</div>
         <div class="singletermTERMS">xsl:template</div>
         <div class="singletermTERMS">xsl:choose</div>
         <div class="singletermTERMS">XMLfr.org</div>
      </div>
      <div class="letterContainerTERMS">
         <div class="letterlableTERMS">y</div>
      </div>
      <div class="letterContainerTERMS">
         <div class="letterlableTERMS">z</div>
      </div>
   </div>
</div>
<div id="mainContainerIML"><a name="XFormsgeneration:arealworldexampleANCHOR" href="#mainContainerTitleTOC" class="anchor">toc</a><div class="article e0" version="5.0-subset Balisage-1.3">
      <div class="title e1">XForms generation: a real world example</div>
      <div class="info e2">
         <div class="confgroup e3">
            <div class="conftitle e4">International Symposium on Native XML User Interfaces</div>
            <div class="confdates e5">August 5, 2013</div>
         </div>
         <div class="abstract e6">
            <div class="para e7">INSEE runs a lot of surveys and needs to make them available on different media: paper
               questionnaires,
               specialized survey software or web forms. As part of an overall effort of rationalization
               of its
               information system, INSEE recently initiated the construction of a central statistical
               metadata
               repository and of a generic platform for survey data collection. We describe in this
               paper a pathfinder
               operation that draws from these two important projects and aims at automating the
               generation of web
               questionnaires from metadata models. We explain the business justification of this
               approach and the
               technological choices made, especially the utilization of XForms. The generation process
               is described in
               detail and the lessons learned from this operation are depicted.
            </div>
         </div>
         <div class="author e8">
            <div class="personname e9">
               <div class="firstname e10">Éric</div>
               <div class="surname e11">Sigaud</div>
            </div>
            <div class="personblurb e12">
               <div class="para e13">Éric is a project manager at INSEE. He is leading the technical part of the Coltrane
                  project which intends to implement a web collect infrastructure based upon XML technologies
                  and XRX architectures.
               </div>
            </div>
            <div class="affiliation e14">
               <div class="orgname e15">INSEE</div>
            </div>
         </div>
         <div class="author e16">
            <div class="personname e17">
               <div class="firstname e18">Romain</div>
               <div class="surname e19">Tailhurat</div>
            </div>
            <div class="personblurb e20">
               <div class="para e21">As a member of INSEE's IT architecture division, Romain's job is to support the developers
                  work by providing technical and methodological guidance and tools to enforce the
                  related choices. Romain is also implied in the setting of the new XML development
                  toolkit. And from time to time, he takes pleasure in coding real applications!
               </div>
            </div>
            <div class="affiliation e22">
               <div class="orgname e23">INSEE</div>
            </div>
         </div>
         <div class="author e24">
            <div class="personname e25">
               <div class="firstname e26">Franck</div>
               <div class="surname e27">Cotton</div>
            </div>
            <div class="personblurb e28">
               <div class="para e29">Franck is a technology evangelist in INSEE, after being successively business statistician,
                  metadata project manager and responsible for IT infrastructure and IT security. He
                  focuses on web standards, especially XML and RDF. He helped organize the uptake of
                  XML development in INSEE and currently spends most of his time promoting the use of
                  metadata
                  standards and linked data technologies in the statistical community.
               </div>
            </div>
            <div class="affiliation e30">
               <div class="orgname e31">INSEE</div>
            </div>
         </div>
         <div class="author e32">
            <div class="personname e33">
               <div class="firstname e34">Éric</div>
               <div class="surname e35">van der Vlist</div>
            </div>
            <div class="personblurb e36">
               <div class="para e37">Éric is an independent consultant and trainer. His domain of expertise include Web
                  development and XML technologies.
               </div>
               <div class="para e38">He is the creator and main editor of 
                  <div xmlns:xlink="http://www.w3.org/1999/xlink" class="link e39" xlink:actuate="onRequest" xlink:href="http://xmlfr.org" xlink:show="new" xlink:type="simple">XMLfr.org</div>, the main site dedicated to XML technologies in French, the author of the O'Reilly
                  animal books XML Schema and RELAX NG and a member or the ISO DSDL (
                  <div xmlns:xlink="http://www.w3.org/1999/xlink" class="link e40" xlink:actuate="onRequest" xlink:href="http://dsdl.org" xlink:show="new" xlink:type="simple">http://dsdl.org</div>) working group focused on XML schema languages.
               </div>
               <div class="para e41">He his based in Paris and you can reach him by mail (
                  <div xmlns:xlink="http://www.w3.org/1999/xlink" class="link e42" xlink:actuate="onRequest" xlink:href="mailto:vdv@dyomedea.com" xlink:show="new" xlink:type="simple">vdv@dyomedea.com</div>) or meet him in one of the many conferences where he
                  presents his projects.
               </div>
            </div>
            <div class="affiliation e43">
               <div class="orgname e44">Dyomedea</div>
            </div>
         </div>
         <div class="legalnotice e45">
            <div class="para e46">This work is made available under a Creative Commons Attribution 3.0 License (CC BY
               3.0) (
               <div xmlns:xlink="http://www.w3.org/1999/xlink" class="link e47" xlink:actuate="onRequest" xlink:href="http://creativecommons.org/licenses/by/3.0/" xlink:show="new" xlink:type="simple">http://creativecommons.org/licenses/by/3.0/</div>).
            </div>
         </div>
      </div><a name="ContextANCHOR" href="#mainContainerTitleTOC" class="anchor">toc</a><div class="section e48">
         <div class="title e49">Context</div>
         <div class="para e50">INSEE (
            <div xmlns:xlink="http://www.w3.org/1999/xlink" class="link e51" xlink:actuate="onRequest" xlink:show="new" xlink:type="simple">http://www.insee.fr/</div>) is France's National Statistical Institute. Like every statistical organization,
            it conducts many surveys on households or enterprises. Forms,
            whether on paper or electronic, are therefore key business objects.
         </div>
         <div class="para e52">For a long time, forms have been designed and managed independently and in a rather
            
            <div class="emphasis e53">ad hoc</div> fashion, but today statistical offices face new challenges (growing
            demand, data deluge, resource constraints, etc., see 
            <div class="xref e54" linkend="hlg-vision"></div>) that urge them to rationalize and industrialize all their business processes.
         </div>
         <div class="para e55">In the case of survey forms, or data acquisition in general, we also have to adapt
            to a growing diversification in the modes of collection: paper, telephone, various
            web devices,
            etc.
         </div>
         <div class="para e56">How should we organize the data collection processes to adapt to this new situation?
            The statistical community has identified some principles to guide the work in that
            respect:
         </div>
         <div class="itemizedlist e57">
            <div class="listitem e58">
               <div class="para e59">rely on standard and shared definitions for the concepts measured, codification, etc.</div>
            </div>
            <div class="listitem e60">
               <div class="para e61">share questions or question blocs across surveys</div>
            </div>
            <div class="listitem e62">
               <div class="para e63">automate the production of the forms, and the retrieval of response data</div>
            </div>
         </div>
         <div class="para e64">This paper describes the application of these ideas to the generation of XForms questionnaires
            for a real business survey (
            <div class="xref e65" linkend="cis"></div>). We first explain in greater detail the
            motivations and the design choices made, then we give the details of the techniques
            employed. As a conclusion, we present some of the lessons learned from this operation
            and evoke some
            future directions.
         </div>
      </div><a name="ThecaseforgeneratingXFormsANCHOR" href="#mainContainerTitleTOC" class="anchor">toc</a><div class="section e66">
         <div class="title e67">The case for generating XForms</div><a name="TheneedofamodelANCHOR" href="#mainContainerTitleTOC" class="anchor">toc</a><div class="section e68">
            <div class="title e69">The need of a model</div>
            <div class="para e70">In this perspective of rationalization of its business process, INSEE launched a number
               of projects, two of which are of particular importance for the subject treated here:
            </div>
            <div class="itemizedlist e71">
               <div class="listitem e72">
                  <div class="para e73">
                     <div class="emphasis e74">RMéS</div>
                     
                     <div class="popupBox e75">
                        <div class="popupLabel" onmouseover="$('#d1e127').show('1000');" onmouseout="$('#d1e127').hide('1000');">[ footnote ]</div>
                        <div id="d1e127" style="display: none;">
                           <div class="footnote">
                              <div class="para e76">Référentiel de métadonnées statistiques</div>
                           </div>
                        </div>
                     </div> aims to build a central management system for statistical metadata
                  </div>
               </div>
               <div class="listitem e77">
                  <div class="para e78">
                     <div class="emphasis e79">Coltrane</div>
                     
                     <div class="popupBox e80">
                        <div class="popupLabel" onmouseover="$('#d1e136').show('1000');" onmouseout="$('#d1e136').hide('1000');">[ footnote ]</div>
                        <div id="d1e136" style="display: none;">
                           <div class="footnote">
                              <div class="para e81">Collecte transversale d'enquêtes</div>
                           </div>
                        </div>
                     </div>, whose goal is to build a unified infrastructure for survey data collection
                  </div>
               </div>
            </div>
            <div class="para e82">The operation described in the present paper sits at the crossroads between these
               two projects, and it has been conducted as a collaboration of the two project teams.
            </div>
            <div class="para e83">The Coltrane project aims to industrialize the collection processes in a variety of
               domains like contact management or authentication methods, but one of its primary
               objectives is to
               build a single platform for collecting survey data, which would replace the different
               systems in use today. This platform needs to be able to collect data in different
               ways, even
               within the same survey:
            </div>
            <div class="para e84">
               
               <div class="itemizedlist e85">
                  <div class="listitem e86">
                     <div class="para e87">with paper questionnaires sent by mail</div>
                  </div>
                  <div class="listitem e88">
                     <div class="para e89">with web forms or electronic documents (PDF, ODF 
                        <div class="popupBox e90">
                           <div class="popupLabel" onmouseover="$('#d1e153').show('1000');" onmouseout="$('#d1e153').hide('1000');">[ footnote ]</div>
                           <div id="d1e153" style="display: none;">
                              <div class="footnote">
                                 <div class="para e91">Open Document Format for Office Applications (
                                    <div xmlns:xlink="http://www.w3.org/1999/xlink" class="link e92" xlink:actuate="onRequest" xlink:show="new" xlink:type="simple">http://en.wikipedia.org/wiki/OpenDocument</div>)
                                 </div>
                              </div>
                           </div>
                        </div>, etc.)
                     </div>
                  </div>
                  <div class="listitem e93">
                     <div class="para e94">with specialized software packages like Blaise 
                        <div class="popupBox e95">
                           <div class="popupLabel" onmouseover="$('#d1e163').show('1000');" onmouseout="$('#d1e163').hide('1000');">[ footnote ]</div>
                           <div id="d1e163" style="display: none;">
                              <div class="footnote">
                                 <div class="para e96">See 
                                    <div xmlns:xlink="http://www.w3.org/1999/xlink" class="link e97" xlink:actuate="onRequest" xlink:show="new" xlink:type="simple">http://www.blaise.com/</div>.
                                 </div>
                              </div>
                           </div>
                        </div>, which is the one used at INSEE
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="para e98">This requirement leads naturally to the idea of creating these different manifestations
               of a given questionnaire from a common representation of the content and the logic
               flow, in
               the most automated fashion possible. This common representation is in fact based on
               metadata.
            </div>
            <div class="para e99">Statistical metadata come in different kinds: concept schemes, code lists and classifications,
               but also quality or methodological metadata, process descriptions, etc. The
               availability of harmonized and good-quality metadata has been identified as a major
               factor of progress for statistical offices.
            </div>
            <div class="para e100">Since metadata provide for the structuring and documentation of the statistical data,
               we need metadata standardization in order to be able to understand and compare data
               or to make
               them interoperable. Different standards exist on the international level for statistical
               metadata, for example SDMX 
               <div class="popupBox e101">
                  <div class="popupLabel" onmouseover="$('#d1e177').show('1000');" onmouseout="$('#d1e177').hide('1000');">[ footnote ]</div>
                  <div id="d1e177" style="display: none;">
                     <div class="footnote">
                        <div class="para e102">Statistical Data and Metadata Exchange</div>
                     </div>
                  </div>
               </div> (
               <div class="xref e103" linkend="sdmx"></div>), an ISO standard focused on the exchange of dimensional data (tables, cubes...)
               and associated metadata, the Neuchâtel Model (
               <div class="xref e104" linkend="neuchatel"></div>), a 
               <div class="emphasis e105">de facto</div> standard representation of statistical classifications or the GSBPM 
               <div class="popupBox e106">
                  <div class="popupLabel" onmouseover="$('#d1e188').show('1000');" onmouseout="$('#d1e188').hide('1000');">[ footnote ]</div>
                  <div id="d1e188" style="display: none;">
                     <div class="footnote">
                        <div class="para e107">Generic Statistical Business Process Model</div>
                     </div>
                  </div>
               </div> (
               <div class="xref e108" linkend="gsbpm"></div>), a common high-level representation of the statistical process.
            </div>
            <div class="para e109">An important goal of the RMéS project is to align INSEE's metadata models on international
               standards.
               But storing or even managing metadata is not enough: we know from experience that
               metadata is not used
               when it is just after-the-fact documentation, for example because the informations
               are not up-to-date.
               What is expected from the RMéS project is the emergence of a metadata-driven information
               system, in
               which the meta-information is actively leveraged in the production process. This means
               that we build on
               these metadata: for example a code list generates controls in a data editing activity,
               or a
               questionnaire description in a specific meta-model is used to produce the actual survey
               instrument.
            </div>
            <div class="para e110">We see that Coltrane and RMéS have a convergent interest: the automatic generation
               of collection instruments from standard metadata-based models of questionnaires.
            </div>
            <div class="figure e111">
               <div class="title e112">Generation of collection instruments</div>
               <div class="mediaobject e113">
                  <div class="imageobject e114">
                     <div class="metaBox e115"><img src="resources/manbluflag.jpg" class="metaImage" onclick="$('#d1e205').toggle('1000');" alt="Marker: click here for details..." title="Marker: click here for details..."><div id="d1e205" class="metaSource" style="display:none;">                
                           &lt;imagedata<span class="metaAttribute">class='e115'
                              </span><span class="metaAttribute">fileref='../../../vol11/graphics/Cotton01/Cotton01-001.png'
                              </span>
                           &gt;
                           
                        </div>
                     </div>
                  </div>
               </div>
            </div>
            <div class="para e116">The studies carried out by both projects concluded that DDI 
               <div class="popupBox e117">
                  <div class="popupLabel" onmouseover="$('#d1e208').show('1000');" onmouseout="$('#d1e208').hide('1000');">[ footnote ]</div>
                  <div id="d1e208" style="display: none;">
                     <div class="footnote">
                        <div class="para e118">Data Documentation Initiative (
                           <div xmlns:xlink="http://www.w3.org/1999/xlink" class="link e119" xlink:actuate="onRequest" xlink:show="new" xlink:type="simple">http://www.ddialliance.org/</div>)
                        </div>
                     </div>
                  </div>
               </div> was the best metadata standard to use for their common purpose.
            </div>
            <div class="para e120">DDI is 
               <div class="quote e121">an international standard for describing data from the social, behavioral, and economic
                  sciences
               </div> (
               <div xmlns:xlink="http://www.w3.org/1999/xlink" class="link e122" xlink:actuate="onRequest" xlink:show="new" xlink:type="simple">http://www.ddialliance.org/what</div>). It is a
               well-established standard for researchers and data archives, and its “Lifecycle” version
               (
               <div class="xref e123" linkend="ddi32"></div>) has more recently attracted attention within the official statistics
               community.
            </div>
            <div class="para e124">As shown in the following picture, DDI is based on a model of the whole data and metadata
               lifecycle during the statistical production process and provides – by design –
               the possibility to convey business information all along this process.
            </div>
            <div class="figure e125">
               <div class="title e126">The statistical process in DDI-Lifecycle</div>
               <div class="mediaobject e127">
                  <div class="imageobject e128">
                     <div class="metaBox e129"><img src="resources/manbluflag.jpg" class="metaImage" onclick="$('#d1e232').toggle('1000');" alt="Marker: click here for details..." title="Marker: click here for details..."><div id="d1e232" class="metaSource" style="display:none;">                
                           &lt;imagedata<span class="metaAttribute">class='e129'
                              </span><span class="metaAttribute">fileref='../../../vol11/graphics/Cotton01/Cotton01-002.png'
                              </span>
                           &gt;
                           
                        </div>
                     </div>
                  </div>
                  <div class="caption e130">
                     <div class="para e131">Copyright © 2013, DDI Alliance</div>
                  </div>
               </div>
            </div>
            <div class="para e132">DDI's “Data collection” module delivers great support for describing survey instruments,
               in particular questionnaires, with their structure and logical flow. This explains
               the choice
               made by the two projects, with RMéS focusing on the elaboration of the DDI models
               and Coltrane on the generation of the survey instruments.
            </div>
         </div><a name="WhyXForms?ANCHOR" href="#mainContainerTitleTOC" class="anchor">toc</a><div class="section e133">
            <div class="title e134">Why XForms?</div>
            <div class="para e135">The different ways to administer a questionnaire do not have the same possibilities.
               Except for visual presentation, paper forms have rather poor functionalities, 
               but but statistical offices have long since developed processes that allow them to
               be used efficiently. Software packages like Blaise are highly specialized and can
               easily handle complex content or logic,
               with rich interfaces for exchanging data. In both cases, business objectives are fulfilled,
               either through the organization or the software features. Web forms or electronic
               documents,
               on the other hand, leverage powerful and versatile technologies that must be tailored
               to the business needs.
            </div>
            <div class="para e136">In order to take the full advantage of web forms, the following requirements were
               selected:
            </div>
            <div class="para e137">
               
               <div class="itemizedlist e138">
                  <div class="listitem e139">
                     <div class="para e140">The possibility to implement the logical flow of the questionnaire</div>
                  </div>
                  <div class="listitem e141">
                     <div class="para e142">The possibility to formalize and execute controls on the client or server side</div>
                  </div>
                  <div class="listitem e143">
                     <div class="para e144">The possibility to inject initialization data (for example for questionnaire personalization)</div>
                  </div>
                  <div class="listitem e145">
                     <div class="para e146">The possibility to produce different variants of a questionnaire depending on the
                        respondent
                     </div>
                  </div>
                  <div class="listitem e147">
                     <div class="para e148">The possibility to easily retrieve the response data</div>
                  </div>
                  <div class="listitem e149">
                     <div class="para e150">The possibility to style user interface elements according to business characteristics
                        of the underlying questionnaire
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="para e151">These requirements combine some aspects that are defined in the abstract model and
               others that depend on the web implementation chosen, so we felt that we needed an
               intermediary
               technical model suited for the web, allowing us a step for processing and additional
               fine-tuning operations on the final questionnaire. We chose to express this technical
               model in
               XForms.
            </div>
            <div class="para e152">XForms is a powerful tool for the distribution of complex forms over the Internet.
               First of all, its design offers an easy way to initialize and capture data and to
               support complex
               dynamic treatments through its Model-View-Controller architecture.
            </div>
            <div class="para e153">Another decisive aspect of our choice is that XForms is the first X of the XRX architecture.
               XRX is XForms-REST-XQuery
               [
               <div xmlns:xlink="http://www.w3.org/1999/xlink" class="link e154" xlink:actuate="onRequest" xlink:show="new" xlink:type="simple">http://en.wikipedia.org/wiki/XRX_(web_application_architecture)</div>], an elegant software architecture which, amongst others, promotes a zero-impedance
               model in which
               data and code are members of the XML family, thus providing a coherent set of technologies.
               Since DDI is also expressed as XML schemas, we had the opportunity to build a completely
               homogenous solution.
            </div>
            <div class="para e155">Finally, the XForms implementations offer both client-side and server-side execution:
               hence we can imagine different balances of both depending on needs.
            </div>
            <div class="para e156">As to the last requirement above, it is easy to include in the XForms technical model
               some CSS references depending on the underlying questionnaire model.
            </div>
            <div class="para e157">Our web forms generation pipeline now looks like this:</div>
            <div class="figure e158">
               <div class="title e159">Generation of web forms – principle</div>
               <div class="mediaobject e160">
                  <div class="imageobject e161">
                     <div class="metaBox e162"><img src="resources/manbluflag.jpg" class="metaImage" onclick="$('#d1e287').toggle('1000');" alt="Marker: click here for details..." title="Marker: click here for details..."><div id="d1e287" class="metaSource" style="display:none;">                
                           &lt;imagedata<span class="metaAttribute">class='e162'
                              </span><span class="metaAttribute">fileref='../../../vol11/graphics/Cotton01/Cotton01-003.png'
                              </span>
                           &gt;
                           
                        </div>
                     </div>
                  </div>
               </div>
            </div>
            <div class="para e163">It is worth noting that although XForms provides a great solution for complex web
               forms, it is a generic design format and so misses information relevant to our activity.
               It would
               not be adequate to use the XForms meta model to store our business information: we
               need a specific model through which we could express our core domain activity, and
               store and reuse
               components. XForms is envisioned as a target model, not a source model.
            </div>
            <div class="para e164">While our primary motivation to generate XForms rather than manually edit them has
               been the need of a generic model, we've found out that this process is a good workaround
               against
               two XForms weaknesses:
               <div class="itemizedlist e165">
                  <div class="listitem e166">
                     <div class="para e167">XForms is based on a pure MVC paradigm which can be an issue when controls or groups
                        of controls are repeated in different contexts in the same form or in different forms
                        (see Eric van der Vlist's “
                        <div xmlns:xlink="http://www.w3.org/1999/xlink" class="link e168" xlink:actuate="onRequest" xlink:href="http://eric.van-der-vlist.com/blog/2013/03/06/when-mvc-becomes-a-burden-for-xforms/" xlink:show="new" xlink:type="simple">When MVC becomes a burden for
                           XForms
                        </div>”). When editing XForms by hand this leads to a number of “copy &amp; paste” which become
                        a nightmare to maintain. When generating XForms these repetitions
                        are not an issue any longer.
                     </div>
                  </div>
                  <div class="listitem e169">
                     <div class="para e170">The current version of XForms (XForms 1.1) is limited and the use of non standard
                        extensions is often necessary to perform complex tasks. These extensions are
                        implementation dependent and non interoperable. When generating XForms from a model,
                        these differences can be seen as minor templates adaptations.
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="para e171">We see from this last point that the XForms generation process must be easily adaptable
               to the target implementation. This idea is at the heart of our generic transformation
               engine.
            </div>
         </div>
      </div><a name="TechnicaldescriptionANCHOR" href="#mainContainerTitleTOC" class="anchor">toc</a><div class="section e172">
         <div class="title e173">Technical description</div>
         <div class="para e174">The next figure shows the technologies chosen to implement the generation process
            described in the previous section.
         </div>
         <div class="figure e175">
            <div class="title e176">Generation of web forms – technologies</div>
            <div class="mediaobject e177">
               <div class="imageobject e178">
                  <div class="metaBox e179"><img src="resources/manbluflag.jpg" class="metaImage" onclick="$('#d1e316').toggle('1000');" alt="Marker: click here for details..." title="Marker: click here for details..."><div id="d1e316" class="metaSource" style="display:none;">                
                        &lt;imagedata<span class="metaAttribute">class='e179'
                           </span><span class="metaAttribute">fileref='../../../vol11/graphics/Cotton01/Cotton01-004.png'
                           </span>
                        &gt;
                        
                     </div>
                  </div>
               </div>
            </div>
         </div>
         <div class="para e180">For the first transformation chain, the input is a questionnaire specification expressed
            in the DDI XML metamodel and the output is an XHTML5 + XForms document representing
            the final
            web form.
         </div>
         <div class="para e181">Since we were transforming XML documents into XML documents, XSLT was of course the
            natural choice. The functional approach and template-matching design of XSLT correspond
            very well with
            our intent to attach a specific web representation to each of our questionnaire metadata
            (questions, data to collect, instructions). We thus designed a base transformation
            engine using
            chained XSLT stylesheets.
         </div>
         <div class="para e182">A notable challenge was to cope with the complexity of the DDI metamodel, which maximizes
            the reusability of metadata elements like questions, code lists, or even texts, and
            also
            implements a very detailed versioning mechanism. As a consequence, DDI documents use
            a lot of chained references to bind logical elements together, and can be quite complex
            and difficult
            to process with XSLT which is more efficient with hierarchical document architecture
            than with relational structures.
         </div>
         <div class="para e183">Therefore, it was easier to design a series of separate steps producing simpler intermediate
            formats of the inputs or outputs, instead of a big and complex transformation.
         </div>
         <div class="para e184">The first step is a DDI compilation, resolving all references and providing a hierarchical
            view of the metadata. Then DDI elements are matched with generic behaviours, as TextInput
            (to
            figure a field designed to collect text), NumericInput, and so on. This is what we
            called the input steps. In the output steps, the behaviours are implemented to generate
            XForms components
            on the fly. At the end, finalization transformations are used to reorganize the outputs
            and render well-formed XForms documents.
         </div>
         <div class="para e185">The overall scripting of the XSLT chain was done with Ant, mainly because it is our
            corporate standard. For a next version of the engine, we are considering using XProc.
         </div>
         <div class="para e186">We've seen that DDI models are focused on describing data rather than surveys (you
            will not find, for
            example, any information in DDI to say if a data should be entered by a drop down
            menu or check boxes). DDI
            includes extension mechanisms which can be used to convey information which can be
            used to generate surveys
            but we prefer to rely on conventions to drive the transformation. In practice these
            conventions are project
            dependent and you need to add customization features to the XSLT engine to ensure
            its flexibility.
         </div>
         <div class="para e187">We added customization stylesheets using xsl:import (as often and in accord with the
            design patterns on overloading). In order to ensure quality and maintainability of
            our XSLT code, a
            careful design of the granularity and naming conventions was required. We defined
            default behaviours – implemented in the default engine – and customized behaviours
            attached
            to questionnaire elements – implemented in the customization stylesheets – when customized
            representations were needed.
         </div>
         <div class="para e188">We chose to specify these customized behaviours with spreadsheets, and more specifically
            ODF spreadsheets (ODS files), thereby preserving the XML homogeneity of our solution.
            The XML
            root structure of these spreadsheets is used as XML input of “configuration XSLT transformations”
            which produce the XSLT customization stylesheets (which, themselves, override some
            of the
            default behaviours of the default engine during the transformation to XHTML5 + XForms).
         </div>
         <div class="figure e189">
            <div class="title e190">Generation of web forms – specification</div>
            <div class="mediaobject e191">
               <div class="imageobject e192">
                  <div class="metaBox e193"><img src="resources/manbluflag.jpg" class="metaImage" onclick="$('#d1e341').toggle('1000');" alt="Marker: click here for details..." title="Marker: click here for details..."><div id="d1e341" class="metaSource" style="display:none;">                
                        &lt;imagedata<span class="metaAttribute">class='e193'
                           </span><span class="metaAttribute">fileref='../../../vol11/graphics/Cotton01/Cotton01-005.png'
                           </span>
                        &gt;
                        
                     </div>
                  </div>
               </div>
            </div>
         </div>
         <div class="para e194">This “spreadsheet-driven architecture” permits business experts to customize their
            questionnaires themselves with tools that they master, without knowing anything about
            XSLT. At this point,
            they still need to be somewhat comfortable with the DDI XML metamodel, but we're considering
            providing a guided interface to reduce, as much as possible, the technical IT requirements
            to design
            questionnaires.
         </div>
      </div><a name="LessonslearnedANCHOR" href="#mainContainerTitleTOC" class="anchor">toc</a><div class="section e195">
         <div class="title e196">Lessons learned</div>
         <div class="para e197">Our first goal was to be able to generate questionnaires using metadata definitions.
            It was not obvious for us that with a metamodel handling only statistical semantics
            we would be
            able to automatically generate all the features needed by our questionnaires. Moreover,
            we were not sure that DDI would support all these features. So, first of all, this
            realization is a
            good proof of concept for us, proof of technical feasibility to drive questionnaire
            generation with metadata. A concrete example of metadata-driven architecture for INSEE
            and the official
            statistics community.
         </div>
         <div class="para e198">Our goal to design a generic engine to industrialize the production of forms customized
            by domain experts has been really challenging and led us to define XSLT design patterns
            such as:
            <div class="itemizedlist e199">
               <div class="listitem e200">
                  <div class="para e201">Use 
                     <div class="code e202">xsl:apply-templates</div>/
                     <div class="code e203">xsl:template</div> rather than 
                     <div class="code e204">xsl:choose</div> as much as possible.
                  </div>
               </div>
               <div class="listitem e205">
                  <div class="para e206">Decouple templates and functions related to the source documents from those in charge
                     of the output tree generation.
                  </div>
               </div>
               <div class="listitem e207">
                  <div class="para e208">Implement the “spreadsheet-driven mechanism” using a functional programming paradigm
                     inspired by 
                     <div xmlns:xlink="http://www.w3.org/1999/xlink" class="link e209" xlink:actuate="onRequest" xlink:href="http://fxsl.sourceforge.net/" xlink:show="new" xlink:type="simple">Dimitre Novatchev's
                        FXSL
                     </div> (we've ruled out XSLT 3.0 features until they are more commonly implemented).
                  </div>
               </div>
            </div>
            
         </div>
         <div class="para e210">The first bullet point is one of the basics of sane XSLT programming but the two others
            – which are
            closely related – go against common XSLT programming. 
         </div>
         <div class="para e211">To write or even just to read and understand most XSLT transformation one must understand
            three different
            domain specific vocabularies:
            <div class="itemizedlist e212">
               <div class="listitem e213">
                  <div class="para e214">XSLT and XPath themselves</div>
               </div>
               <div class="listitem e215">
                  <div class="para e216">The knowledge of the vocabulary used by the source document is required to understand
                     most
                     XPath expressions
                  </div>
               </div>
               <div class="listitem e217">
                  <div class="para e218">The knowledge of the vocabulary used by the result document is necessary to understand
                     the
                     production of literals and the general structure of the transformation.
                  </div>
               </div>
            </div>
         </div>
         <div class="para e219">For this project the team was spread over multiple departments, profiles and geographical
            locations and
            composed of:
            <div class="itemizedlist e220">
               <div class="listitem e221">
                  <div class="para e222">Business experts whose job is to design surveys and DDI experts who create the DDI
                     model for
                     these surveys
                  </div>
               </div>
               <div class="listitem e223">
                  <div class="para e224">XSLT developers who speak fluently DDI and have a basic knowledge of XForms</div>
               </div>
               <div class="listitem e225">
                  <div class="para e226">XForms experts who are also fluent XSLT developers but are puzzled by the complexity
                     of
                     DDI.
                  </div>
               </div>
            </div>
         </div>
         <div class="para e227">The use of spreadsheets to generate XSLT templates has been a first step in the separation
            of concerns
            between design and implementation and we've gone a step further and separated as much
            as possible the
            concerns between DDI and XForms expertise so that in this loosely coupled team each
            profile could work as
            independently as possible.
         </div>
         <div class="para e228">This second step has been achieved by defining, like we would have done in any other
            programming language,
            an 
            <div xmlns:xlink="http://www.w3.org/1999/xlink" class="link e229" xlink:actuate="onRequest" xlink:href="http://en.wikipedia.org/wiki/Interface_%28computer_science%29" xlink:show="new" xlink:type="simple">interface</div> between
            everything related to DDI and anything related to XForms, the challenge being to define
            how this interface
            should be organized to take advantage of the template oriented nature of XSLT while
            performing this
            separation of concerns between source and result vocabularies.
         </div>
         <div class="para e230">The separation of concerns being materialized by splitting XSLT stylesheets between
            anything related to
            the source document and anything related to the result tree, the source related templates
            which are
            generated from the spreadsheet build a dynamic document, called the "driver" because
            its role is to drive
            the generation of the result tree and apply the templates on driver's nodes.
         </div>
         <div class="para e231">Result oriented templates match driver nodes to create the result tree and use a set
            of accessors
            functions implemented by the source oriented stylesheets to get any additional info
            they may need. An
            additional interface function implemented by source stylesheets returns the nodeset
            considered as the
            logical children of the context node from the source document. 
         </div>
         <div class="para e232">This can be seen as a dialog between source and result stylesheets:
            <div class="itemizedlist e233">
               <div class="listitem e234">
                  <div class="para e235">
                     <div class="emphasis e236" role="bold">Source</div>: Hmmm, my context node should be translated into this
                     XForms control. I append the element identifying this control to the driver and apply
                     the
                     templates in result mode on this element in the driver.
                  </div>
               </div>
               <div class="listitem e237">
                  <div class="para e238">
                     <div class="emphasis e239" role="bold">Result</div>: I see in the driver that I need to generate this
                     XForms control. Please give me (using accessor functions) these information.
                  </div>
               </div>
               <div class="listitem e240">
                  <div class="para e241">
                     <div class="emphasis e242" role="bold">Result</div>: I am done with this control, tell me which are the
                     logical children of your context node so that I can apply the templates in source
                     mode on these
                     children.
                  </div>
               </div>
            </div>
         </div>
         <div class="para e243">We have found this design pattern very effective during our implementation.</div>
         <div class="para e244">To develop the result stylesheets which generate Orbeon Form Builder forms, we've
            written a set of source
            stylesheets implementing this interface on source documents which are... Form Builder
            forms! The combination
            gave us an identity transformation which has been very handy to debug the result stylesheets.
         </div>
         <div class="para e245">Different flavors of the result stylesheets are also being developed to generate "pure"
            XForms forms for
            different implementations (Orbeon, XSLTForms and betterFORM) and this separation of
            concerns greatly
            facilitates this development. The main difficulties met so far are related to the
            lack of interoperability
            of the different XForms implementations.
         </div>
         <div class="para e246">The deployment of a first survey in production on Orbeon Form Runner has not shown
            any performance issue
            despite the size of the form (15,000 lines, 10,000 elements, 1.1 Mo).
         </div>
         <div class="para e247">The development described in this paper has validated our approach of generating surveys
            instruments from
            questionnaire descriptions. This approach had previously been applied to the generation
            of electronic
            documents (ODF), but targeting XForms led us to a much more flexible and configurable
            solution. We now
            envision with confidence the possibility of generating entirely new formats like Blaise.
         </div>
      </div><a name="BibliographyANCHOR" href="#mainContainerTitleTOC" class="anchor">toc</a><div class="bibliography e248">
         <div class="title e249">Bibliography</div>
         <div class="bibliomixed e250" xml:id="hlg-vision" xreflabel="HLG-BAS Vision">UNECE, 
            <div class="quote e251">Strategic vision of the High-Level Group for the Modernisation of Statistical Production
               and Services
            </div>,
            
            <div xmlns:xlink="http://www.w3.org/1999/xlink" class="link e252" xlink:actuate="onRequest" xlink:show="new" xlink:type="simple">http://www1.unece.org/stat/platform/display/hlgbas/Strategic+vision+of+the+HLG</div>
         </div>
         <div class="bibliomixed e253" xml:id="cis" xreflabel="CIS">CIS, 
            <div class="quote e254">Community Innovation Statistics</div>. 
            <div xmlns:xlink="http://www.w3.org/1999/xlink" class="link e255" xlink:actuate="onRequest" xlink:show="new" xlink:type="simple">http://epp.eurostat.ec.europa.eu/portal/page/portal/microdata/cis</div>
         </div>
         <div class="bibliomixed e256" xml:id="ddi32" xreflabel="DDI 3.2">DDI Alliance, 
            <div class="quote e257">DDI 3.2 (Public Review Version)</div>.
            
            <div xmlns:xlink="http://www.w3.org/1999/xlink" class="link e258" xlink:actuate="onRequest" xlink:show="new" xlink:type="simple">http://www.ddialliance.org/Specification/DDI-Lifecycle/3.2/</div>
         </div>
         <div class="bibliomixed e259" xml:id="sdmx" xreflabel="SDMX">SDMX Sponsors, 
            <div class="quote e260">Statistical Data and Metadata Exchange</div>, 
            <div xmlns:xlink="http://www.w3.org/1999/xlink" class="link e261" xlink:actuate="onRequest" xlink:show="new" xlink:type="simple">http://sdmx.org/</div>
         </div>
         <div class="bibliomixed e262" xml:id="neuchatel" xreflabel="NEUCHATEL">UNECE, 
            <div class="quote e263">Neuchâtel Terminology Model for classifications</div>,
            
            <div xmlns:xlink="http://www.w3.org/1999/xlink" class="link e264" xlink:actuate="onRequest" xlink:show="new" xlink:type="simple">http://www1.unece.org/stat/platform/pages/viewpage.action?pageId=14319930</div>
         </div>
         <div class="bibliomixed e265" xml:id="gsbpm" xreflabel="GSBPM">UNECE, 
            <div class="quote e266">The Generic Statistical Business Process Model</div>,
            
            <div xmlns:xlink="http://www.w3.org/1999/xlink" class="link e267" xlink:actuate="onRequest" xlink:show="new" xlink:type="simple">http://www1.unece.org/stat/platform/display/metis/The+Generic+Statistical+Business+Process+Model</div>
         </div>
      </div>
   </div>
</div>