<?xml version="1.0" encoding="UTF-8" standalone="no"?><classedDocument><article xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" class="po-hcontainer e0 e0" version="5.0-subset Balisage-1.3"><title class="po-block e1 e1"><textual class="po-textual">One Href is not Enough</textual></title><subtitle class="po-block e2 e2"><textual class="po-textual">We need n hrefs!</textual></subtitle><info class="po-record e3 e3"><confgroup class="po-record e4 e4"><conftitle class="po-field e5 e5"><textual class="po-textual">Balisage: The Markup Conference 2011</textual></conftitle><confdates class="po-field e6 e6"><textual class="po-textual">August 2 - 5, 2011</textual></confdates></confgroup><abstract class="po-container e7 e7"><para class="po-block e8 e8"><textual class="po-textual">The web is hyperlinks for the masses. </textual></para><para class="po-block e9 e9"><textual class="po-textual">Hyperlinks are an old concept that has been invented before the web and to achieve this remarkable success, the web had to come out
                with a very simplified version of hyperlinks.</textual></para><para class="po-block e10 e10"><textual class="po-textual">In the process a lot of features have been lost and some of them, such as the possibility to link to multiple targets have been
                lost.</textual></para><para class="po-block e11 e11"><textual class="po-textual">This talk proposes to use modern techniques to regain this ability while remaining conform to existing standards and running in
                existing browsers. </textual></para></abstract><author class="po-record e12 e12"><personname class="po-record e13 e13"><firstname class="po-field e14 e14"><textual class="po-textual">Eric</textual></firstname><surname class="po-field e15 e15"><textual class="po-textual">van der Vlist</textual></surname></personname><personblurb class="po-container e16 e16"><para class="po-block e17 e17"><textual class="po-textual">Eric is an independent consultant and trainer. His domain of expertise include Web development and XML technologies.</textual></para><para class="po-block e18 e18"><textual class="po-textual">He is the creator and main editor of </textual><link class="po-inline e19 e19" xlink:actuate="onRequest" xlink:href="http://xmlfr.org" xlink:show="new" xlink:type="simple"><textual class="po-textual">XMLfr.org</textual></link><textual class="po-textual">, the main site dedicated to XML
                    technologies in French, the author of the O'Reilly animal books XML Schema and RELAX NG and a member or the ISO DSDL (</textual><link class="po-inline e20 e20" xlink:actuate="onRequest" xlink:href="http://dsdl.org" xlink:show="new" xlink:type="simple"><textual class="po-textual">http://dsdl.org</textual></link><textual class="po-textual">) working group focused on XML schema languages.</textual></para><para class="po-block e21 e21"><textual class="po-textual">He his based in Paris and you can reach him by mail (</textual><link class="po-inline e22 e22" xlink:actuate="onRequest" xlink:href="mailto:vdv@dyomedea.com" xlink:show="new" xlink:type="simple"><textual class="po-textual">vdv@dyomedea.com</textual></link><textual class="po-textual">) or meet
                    him in one of the many conferences where he presents his projects.</textual></para></personblurb><affiliation class="po-record e23 e23"><orgname class="po-block e24 e24"><textual class="po-textual">Dyomedea</textual></orgname></affiliation></author><legalnotice class="po-container e25 e25"><para class="po-block e26 e26"><textual class="po-textual">Copyright Â© 2011 by the author. Used with permission.</textual></para></legalnotice></info><section class="po-hcontainer e27 e27"><title class="po-block e28 e28"><textual class="po-textual">Introduction</textual></title><para class="po-block e29 e29"><textual class="po-textual">I am a </textual><link class="po-inline e30 e30" xlink:actuate="onRequest" xlink:href="http://www.urbandictionary.com/define.php?term=webaholic" xlink:show="new" xlink:type="simple"><textual class="po-textual">webaholic</textual></link><textual class="po-textual">: the web has changed my life and it has
            changed the way I write: links are disruptive and my writing is no longer the same since I can use them.</textual></para><para class="po-block e31 e31"><textual class="po-textual">Before the web (and before the links) you had to be very careful to be understood and introduce all the words that were not commonly
            known or disambiguate those that could be ambiguous.</textual></para><para class="po-block e32 e32"><textual class="po-textual">Now that we have links, we can use them for these two purposes and concentrate on the message we express. This leads to a new
            conciseness that I love.</textual></para><para class="po-block e33 e33"><textual class="po-textual">Unfortunately when you use links a lot you run rapidly into trouble...</textual></para><para class="po-block e34 e34"><textual class="po-textual">The other day, I was writing a blog post to announce that my paper had been accepted at XPL Prague:</textual></para><blockquote class="po-container e35 e35"><para class="po-block e36 e36"><textual class="po-textual">Just got the confirmation that I'll be presenting a paper on XQuery injection at XML Prague March 26th or 27th.</textual></para><attribution class="po-block e37 e37"><link class="po-inline e38 e38" xlink:actuate="onRequest" xlink:href="http://eric.van-der-vlist.com/blog/2011/01/26/see-you-in-prague/" xlink:show="new" xlink:type="simple"><textual class="po-textual">See you in Prague</textual></link></attribution></blockquote><para class="po-block e39 e39"><textual class="po-textual">While typing the obvious question arose: where should I link "XQuery" to?</textual></para><itemizedlist class="po-table e40 e40"><listitem class="po-container e41 e41"><para class="po-block e42 e42"><textual class="po-textual">To Wikipedia which is usually a good choice because it provides cool URIs (that don't change) and pages that introduce a
                    subject?</textual></para></listitem><listitem class="po-container e43 e43"><para class="po-block e44 e44"><textual class="po-textual">To the W3C recommendation which is another cool URI (that doesn't change) and is the normative reference but isn't an
                    introductory material?</textual></para></listitem><listitem class="po-container e45 e45"><para class="po-block e46 e46"><textual class="po-textual">Elsewhere (to the XQuery tag on my blog, to the W3C XML Query Working Group,...)?</textual></para></listitem></itemizedlist><para class="po-block e47 e47"><textual class="po-textual">And, for versioned resources such as Wikipedia pages or W3C recommendations should I link to the current version at the date when I
            wrote the blog entry or to an updated, latest version?</textual></para><para class="po-block e48 e48"><textual class="po-textual">All these choices make sense but (X)HTML imposes to chose one and only one target for a link!</textual></para><para class="po-block e49 e49"><textual class="po-textual">The problem got worse when I was typing "XML Prague" because I had to choose between:</textual></para><itemizedlist class="po-table e50 e50"><listitem class="po-container e51 e51"><para class="po-block e52 e52"><textual class="po-textual">Linking "XML" and "Prague" separately (and again, to which target? Wikipedia, the W3C recommendation, the XML category for
                    "XML"; Wikipedia, tourist office, ... for "Prague")</textual></para></listitem><listitem class="po-container e53 e53"><para class="po-block e54 e54"><textual class="po-textual">Linking "XML Prague" as a whole to the conference web site or the tag on my blog.</textual></para></listitem></itemizedlist><para class="po-block e55 e55"><textual class="po-textual">This issue of embedded links seems really tough and I think I could live with it but wanted to mention it for completeness.</textual></para><para class="po-block e56 e56"><textual class="po-textual">The problem can also get worse when I write in French because I often want to give the choice between targets in French and targets in
            English when they are higher quality...</textual></para><para class="po-block e57 e57"><textual class="po-textual">In other words: one href is not enough, we need n hrefs!</textual></para><para class="po-block e58 e58"><textual class="po-textual">Am I asking too much?</textual></para><para class="po-block e59 e59"><textual class="po-textual">I don't think so, my requirements are legitimate and generic: I want to be able to write simple sentences using the words that are
            relevant in my domain(s) while using links to give to my readers the ability to discover the meaning of the words that they don't know,
            browse authoritative resources to deepen or extend their knowledge or find out relative pages that I have written.</textual></para><para class="po-block e60 e60"><textual class="po-textual">Furthermore this is an old issue already addressed in SGML world by HyTime and acknowledged by the W3C back in 1997!</textual></para><para class="po-block e61 e61"><textual class="po-textual">What happened then?</textual></para><para class="po-block e62 e62"><textual class="po-textual">The topic has always been considered touchy and the first working draft published in April 97 as "Extensible Markup Language (XML): Part
            2. Linking" notes:</textual></para><blockquote class="po-container e63 e63"><para class="po-block e64 e64"><textual class="po-textual">Please be advised that the draft you are now reading is </textual><emphasis class="po-inline e65 e65"><textual class="po-textual">unusually volatile</textual></emphasis><textual class="po-textual">. The debating and balloting process
                which determines the material contents is far from complete, and is nonetheless substantially ahead of the editing process that turns
                the material contents into usable specification language.</textual></para><attribution class="po-block e66 e66"><link class="po-inline e67 e67" xlink:actuate="onRequest" xlink:href="http://www.w3.org/TR/WD-xml-link-970406" xlink:show="new" xlink:type="simple"><textual class="po-textual">Extensible Markup Language (XML): Part 2.
                Linking</textual></link></attribution></blockquote><para class="po-block e68 e68"><textual class="po-textual">The content was indeed so volatile that the specification was taken out of the XML recommendation and eventually became a recommendation
            no less that four years after in June 2001. This recommendation, known as XLink, does address what I need:</textual></para><blockquote class="po-container e69 e69"><para class="po-block e70 e70"><textual class="po-textual">This specification defines the XML Linking Language (XLink), which allows elements to be inserted into XML documents in order to
                create and describe links between resources. It uses XML syntax to create structures that can describe links similar to the simple
                unidirectional hyperlinks of today's HTML, as well as more sophisticated links.</textual></para><attribution class="po-block e71 e71"><link class="po-inline e72 e72" xlink:actuate="onRequest" xlink:href="http://www.w3.org/TR/2001/REC-xlink-20010627/" xlink:show="new" xlink:type="simple"><textual class="po-textual">XML Linking Language (XLink) Version 1.0</textual></link></attribution></blockquote><para class="po-block e73 e73"><textual class="po-textual">Unfortunately, without wanting to start a flame war nor blame anyone, I think it is fair to say that the syntax of these sophisticated links mentioned in this introduction and known as
            "extended links" is so complex that they are considered unusable by most of us XML geeks and have no chance to be embedded in real world (X)HTML pages. If you're not convinced by this bold
            statement, please hold on: I'll come back on extended XLinks in a while... </textual></para><para class="po-block e74 e74"><textual class="po-textual">Is this topic doomed then? How can we go through when previous attempts seem to have all failed?</textual></para><para class="po-block e75 e75"><textual class="po-textual">Ten years have passed since 2001 and one of the things we've learned is to hijack existing technologies to do what we need! Some
            hijacking technologies have even become de facto standards... Why not call them to the rescue?</textual></para><para class="po-block e76 e76"><textual class="po-textual">In other words, why not use microformats, RDFa or HTML5's microdata to specify these "sophisticated links" that are missing to
            XML?</textual></para></section><section class="po-hcontainer e77 e77"><title class="po-block e78 e78"><textual class="po-textual">Requirements</textual></title><para class="po-block e79 e79"><textual class="po-textual">Please take the remaining of this paper as a demonstration of how this problem could be handled rather than a final proposition...</textual></para><para class="po-block e80 e80"><textual class="po-textual">The requirements that are chosen here are arbitrary: they meet what I find important as I write these lines and are subject to discussion but I am confident that the same method can be
            used with different requirements sets as long as they remain "reasonably" simple!</textual></para><para class="po-block e81 e81"><textual class="po-textual">The requirements for this exercise can be summarized as defining a (X)HTML jargon (microformat, RDFa, microdata, ...) that:</textual></para><orderedlist class="po-table e82 e82"><listitem class="po-container e83 e83"><para class="po-block e84 e84"><textual class="po-textual">Expresses inline links with multiple arcs between (X)HTML fragments and several link ends.</textual></para></listitem><listitem class="po-container e85 e85"><para class="po-block e86 e86"><textual class="po-textual">Can be processed by a simple JavaScript library to be displayed in a fancy way.</textual></para></listitem><listitem class="po-container e87 e87"><para class="po-block e88 e88"><textual class="po-textual">Degrades nicely and remains readable when not processed by such a library.</textual></para></listitem><listitem class="po-container e89 e89"><para class="po-block e90 e90"><textual class="po-textual">Plays well with search engines.</textual></para></listitem><listitem class="po-container e91 e91"><para class="po-block e92 e92"><textual class="po-textual">Do not requires server storage.</textual></para></listitem><listitem class="po-container e93 e93"><para class="po-block e94 e94"><textual class="po-textual">If possible, provides a way to annotate the arcs (to provide arc roles, the language of link ends or other informations).</textual></para></listitem><listitem class="po-container e95 e95"><para class="po-block e96 e96"><textual class="po-textual">If possible, support embedded links.</textual></para></listitem></orderedlist><para class="po-block e97 e97"><textual class="po-textual">The general idea is to keep the thing as simple as possible while maintaining good practices!</textual></para><para class="po-block e98 e98"><textual class="po-textual">Requirement 3 excludes solutions such as </textual><link class="po-inline e99 e99" xlink:actuate="onRequest" xlink:href="http://www.webresourcesdepot.com/multiple-links-inside-one-pluralink/" xlink:show="new" xlink:type="simple"><textual class="po-textual">pluralink</textual></link><textual class="po-textual"> that package multiple links into a single href attribute and is not "degradable" since the link doesn't work if it
            isn't processed by a script.</textual></para><para class="po-block e100 e100"><textual class="po-textual">Requirements 3 and 4 can be contradictory. Taken alone, point 3 would lead to defining a jargon that would replace "XQuery" by
            "XQuery [Wikipedia, W3C]" with links between the words "Wikipedia" and "W3C" and (respectively) the article about XQuery on Wikipedia and
            the XQuery W3C recommendation but the practice may be considered as an almost as poor as the infamous </textual><link class="po-inline e101 e101" xlink:actuate="onRequest" xlink:href="http://www.w3.org/QA/Tips/noClickHere" xlink:show="new" xlink:type="simple"><textual class="po-textual">"Click here" practice</textual></link><textual class="po-textual">!</textual></para><para class="po-block e102 e102"><textual class="po-textual">Requirement 4 will thus lead to more verbose alternatives such as "XQuery [XQuery on Wikipedia, XQuery W3C Recommendation]" with links
            on "XQuery on Wikipedia" and "XQuery W3C Recommendation".</textual></para><para class="po-block e103 e103"><textual class="po-textual">Requirement 5 excludes services such as </textual><link class="po-inline e104 e104" xlink:actuate="onRequest" xlink:href="http://www.multiurl.com/" xlink:show="new" xlink:type="simple"><textual class="po-textual">http://www.multiurl.com/</textual></link><textual class="po-textual"> that are similar to URL
            shorteners with the additional possibility to define multiple targets.</textual></para><note class="po-container e105 e105"><para class="po-block e106 e106"><textual class="po-textual">This is a simplified set of requirements and that do not take into account chained links such as the relation between a page and its archive or translation. In this first version the
                arcs are between a document fragment and multiple resources that are all at the same level. In a next iteration, we'll have to see how this can be extended to introduce relations
                between linked resources.</textual></para></note></section><section class="po-hcontainer e107 e107"><title class="po-block e108 e108"><textual class="po-textual">First Step: Without Embedded Links</textual></title><para class="po-block e109 e109"><textual class="po-textual">Let's first keep things simple and explore simple implementations for microformats, RDFa and microdata.</textual></para><para class="po-block e110 e110"><textual class="po-textual">In each case, we will present the markup to express an nhrefs link and the corresponding JavaScript implementation.</textual></para><para class="po-block e111 e111"><textual class="po-textual">This implementation will loop over nhrefs links and for each link it will hide the original markup but keep it intact so that other
            scripts could access the information for other purposes if that was necessary. For each link, a dialog will be created and a simple link
            will be added to open this dialog.</textual></para><section class="po-hcontainer e112 e112"><title class="po-block e113 e113"><textual class="po-textual">Kissing with Microformat</textual></title><para class="po-block e114 e114"><textual class="po-textual">The good thing with microformats is that their "balisage" is flexible and they often can be kept as simple as possible...</textual></para><para class="po-block e115 e115"><textual class="po-textual">In our case, the following seems to be good enough (indentation has been added to make the code more readable):</textual></para><programlisting class="po-block e116 e116" xml:space="preserve"><textual class="po-textual">&lt;span class="nhrefs"&gt;
    &lt;span class="source"&gt;XQuery&lt;/span&gt; 
    [
        &lt;a href="http://en.wikipedia.org/wiki/XQuery" class="arc" rel="wikipedia"&gt;XQuery on Wikipedia&lt;/a&gt;, 
        &lt;a href="http://www.w3.org/TR/xquery/" class="arc" rel="authoritative"&gt;XQuery W3C Recommendation&lt;/a&gt;
    ]
&lt;/span&gt;</textual></programlisting><para class="po-block e117 e117"><textual class="po-textual">Where:</textual></para><variablelist class="po-table e118 e118"><varlistentry class="po-record e119 e119"><term class="po-block e120 e120"><textual class="po-textual">span.nhrefs</textual></term><listitem class="po-container e121 e121"><para class="po-block e122 e122"><textual class="po-textual">Is the container for an extended link.</textual></para></listitem></varlistentry><varlistentry class="po-record e123 e123"><term class="po-block e124 e124"><textual class="po-textual">span.source</textual></term><listitem class="po-container e125 e125"><para class="po-block e126 e126"><textual class="po-textual">Is the source of the link (the link start if you prefer). This source is always local to the document.</textual></para></listitem></varlistentry><varlistentry class="po-record e127 e127"><term class="po-block e128 e128"><textual class="po-textual">a.arc</textual></term><listitem class="po-container e129 e129"><para class="po-block e130 e130"><textual class="po-textual">Is an arc.</textual></para></listitem></varlistentry><varlistentry class="po-record e131 e131"><term class="po-block e132 e132"><textual class="po-textual">a.arc/@rel</textual></term><listitem class="po-container e133 e133"><para class="po-block e134 e134"><textual class="po-textual">Is the arc role (using curies and/or a set of well known common roles).</textual></para></listitem></varlistentry><varlistentry class="po-record e135 e135"><term class="po-block e136 e136"><textual class="po-textual">a.arc/@href</textual></term><listitem class="po-container e137 e137"><para class="po-block e138 e138"><textual class="po-textual">Is the URL of the arc destination.</textual></para></listitem></varlistentry><varlistentry class="po-record e139 e139"><term class="po-block e140 e140"><textual class="po-textual">a.arc/node()</textual></term><listitem class="po-container e141 e141"><para class="po-block e142 e142"><textual class="po-textual">Is the label of the arc end.</textual></para></listitem></varlistentry></variablelist><para class="po-block e143 e143"><textual class="po-textual">This format degrades reasonably well when it is not processed by any kind of script:</textual></para><figure class="po-container e144 e144"><title class="po-block e145 e145"><textual class="po-textual">Microformat not processed by a script</textual></title><mediaobject class="po-container e146 e146"><imageobject class="po-container e147 e147"><imagedata class="po-meta e148 e148" fileref="../../../vol7/graphics/Vlist01/Vlist01-001.png" format="png"><textual class="po-textual">Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao</textual></imagedata></imageobject></mediaobject><caption class="po-container e149 e149"><para class="po-block e150 e150"><textual class="po-textual">Snapshot of my blog using this microformat to link the word "XQuery" to its Wikipedia definition and its W3C recommendation when
                    the page is not processed by a script.</textual></para></caption></figure><para class="po-block e151 e151"><textual class="po-textual">With a simple JavaScript function, this text can be streamlined into:</textual></para><figure class="po-container e152 e152"><title class="po-block e153 e153"><textual class="po-textual">Microformat processed by a script</textual></title><mediaobject class="po-container e154 e154"><imageobject class="po-container e155 e155"><imagedata class="po-meta e156 e156" fileref="../../../vol7/graphics/Vlist01/Vlist01-002.png" format="png"><textual class="po-textual">Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao</textual></imagedata></imageobject></mediaobject><caption class="po-container e157 e157"><para class="po-block e158 e158"><textual class="po-textual">Snapshot of my blog using this microformat to link the word "XQuery" to its Wikipedia definition and its W3C recommendation and
                    streamlined by a script.</textual></para></caption></figure><para class="po-block e159 e159"><textual class="po-textual">This script opens a dialog when you click on link that has been generated around the word "XQuery":</textual></para><figure class="po-container e160 e160"><title class="po-block e161 e161"><textual class="po-textual">Microformat processed by a script after a click</textual></title><mediaobject class="po-container e162 e162"><imageobject class="po-container e163 e163"><imagedata class="po-meta e164 e164" fileref="../../../vol7/graphics/Vlist01/Vlist01-003.png" format="png"><textual class="po-textual">Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao</textual></imagedata></imageobject></mediaobject><caption class="po-container e165 e165"><para class="po-block e166 e166"><textual class="po-textual">Snapshot of my blog using this microformat to link the word "XQuery" to its Wikipedia definition and its W3C recommendation,
                    streamlined by a script and after a click.</textual></para></caption></figure><para class="po-block e167 e167"><textual class="po-textual">If you wonder the level of complexity of such a script, here is a version that uses jQuery (the code could probably be further
            simplified: I am not a jQuery expert):</textual></para><programlisting class="po-block e168 e168" xml:space="preserve"><textual class="po-textual">jQuery(document).ready(function() {
 
    jQuery('.nhrefs')
        .each(function() {
    
            var span = jQuery(this);
            span.hide();
            var source = jQuery('.source', this).text();
            var link = jQuery(span.before('&lt;a href=""&gt;'+ source +'&lt;/a&gt;')[0].previousSibling);
            var dialog = jQuery(span.before('&lt;div title="Links for &amp;quot;'+ source + '&amp;quot;"&gt;&lt;ul /&gt; &lt;/div&gt;')[0].previousSibling);
            var list = jQuery('ul', dialog);
            jQuery('a.arc', this)
                .each(function(){
                    list.append('&lt;li&gt;&lt;a href="' + this.href + '"&gt;' + this.text + '&lt;/a&gt;');
                });
            dialog.dialog({ autoOpen: false });
            link.click(function() {
                dialog.dialog("open");
                return false;
            }); 
        });

 });</textual></programlisting></section><section class="po-hcontainer e169 e169"><title class="po-block e170 e170"><textual class="po-textual">Tripling with RDFa</textual></title><para class="po-block e171 e171"><textual class="po-textual">The good thing with RDFa is that assertions can be extracted using any tool of a generic toolbox.</textual></para><para class="po-block e172 e172"><textual class="po-textual">The price to pay is that your markup needs to follow a set of rules that are much more rigid than those of microformats...</textual></para><para class="po-block e173 e173"><textual class="po-textual">In our case, here is the simplest markup I have been able to produce (enhancements welcome, especially if they simplify the
            source!):</textual></para><programlisting class="po-block e174 e174" xml:space="preserve"><textual class="po-textual">&lt;span typeof="nhrefs:link"&gt;
    &lt;span property="nhrefs:source"&gt;XQuery&lt;/span&gt; 
    &lt;span rel="nhrefs:hasarc"&gt;
        [&lt;span typeof="nhrefs:arc"&gt;
            &lt;a href="http://en.wikipedia.org/wiki/XQuery" rel="nhrefs:dest" property="nhrefs:title"&gt;XQuery on Wikipedia&lt;/a&gt; 
            &lt;span rel="nhrefs:role" resource="nhrefs:wikipedia"&gt;&lt;span&gt;
        &lt;/span&gt;, 
        &lt;span typeof="typeof:arc"&gt;
            &lt;a href="http://www.w3.org/TR/xquery/" rel="nhrefs:dest" property="nhrefs:title"&gt;XQuery W3C Recommendation&lt;/a&gt;
            &lt;span rel="nhrefs:role" resource="nhrefs:authoritative"&gt;&lt;/span&gt;
        &lt;/span&gt;]
    &lt;/span&gt;
&lt;/span&gt;</textual></programlisting><para class="po-block e175 e175"><textual class="po-textual">This code get displayed exactly like its microformat counterpart when it is not processed by a script.</textual></para><para class="po-block e176 e176"><textual class="po-textual">Although this snippet is more verbose than its microformat equivalent, it is arguably more "auto documented" and any reader (human or
            not) familiar with RDFa can understand that we have here a "nhrefs:link" with a source and a couple of arcs... </textual></para><para class="po-block e177 e177"><textual class="po-textual">Here is how Raptor RDF sees it (with some help from Graphviz):</textual></para><figure class="po-container e178 e178"><title class="po-block e179 e179"><textual class="po-textual">An Nhrefs Link expressed in RDFa</textual></title><mediaobject class="po-container e180 e180"><imageobject class="po-container e181 e181"><imagedata class="po-meta e182 e182" fileref="../../../vol7/graphics/Vlist01/Vlist01-004.png" format="png"><textual class="po-textual">Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao</textual></imagedata></imageobject></mediaobject><caption class="po-container e183 e183"><para class="po-block e184 e184"><textual class="po-textual">The example previous example parsed by Raptor RDF and visualized by Graphviz.</textual></para></caption></figure><para class="po-block e185 e185"><textual class="po-textual">More concisely, it can be represented in turtle as:</textual></para><programlisting class="po-block e186 e186" xml:space="preserve"><textual class="po-textual">@prefix rdf: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt; .
@prefix : &lt;http://www.w3.org/1999/xhtml&gt; .
@prefix nhrefs: &lt;http://nhrefs.org/&gt; .

[]
    nhrefs:hasarc [
        nhrefs:dest &lt;http://www.w3.org/TR/xquery/&gt; ;
        nhrefs:role &lt;nhrefs:authoritative&gt; ;
        nhrefs:title "XQuery W3C Recommendation"
    ], [
        nhrefs:dest &lt;http://en.wikipedia.org/wiki/XQuery&gt; ;
        nhrefs:role &lt;nhrefs:wikipedia&gt; ;
        nhrefs:title "XQuery on Wikipedia" ;
        a nhrefs:arc
    ] ;
    nhrefs:source "XQuery" ;
    a nhrefs:link .
</textual></programlisting><para class="po-block e187 e187"><textual class="po-textual">Nice, don't you think so? </textual></para><para class="po-block e188 e188"><textual class="po-textual">To be honest, there is a flaw in this model: the arcs are embedded in a blank node without using any container and in that case RDF
                specifies that the triples are unordered. In other words, there is no guarantee that the relative order of the arcs will be
                kept.</textual></para><para class="po-block e189 e189"><textual class="po-textual">Neither the current recommendation (RDFa1.0) nor the latest RDFa 1.1 Working Draft support containers but a </textual><link class="po-inline e190 e190" xlink:actuate="onRequest" xlink:href="http://www.w3.org/2010/02/rdfa/wiki/ContainersAndCollections" xlink:show="new" xlink:type="simple"><textual class="po-textual">proposal</textual></link><textual class="po-textual"> has been made on the RDFa wiki and I do hope that this most needed feature will be added to RDFa at some
                point.</textual></para><para class="po-block e191 e191"><textual class="po-textual">This is only a problem as far as authors expect this order to be preserved (which is probably the case) and if we use a RDF library
                that may change this order (which is not the case of the library that we'll be using) but this is still a flaw. </textual></para><para class="po-block e192 e192"><textual class="po-textual">A RDF library... Yep, let's see how you parse that kind of thing in JavaScript!</textual></para><para class="po-block e193 e193"><textual class="po-textual">It could be tempting to use a library such as jQuery and just adapt what we've done for microformats to query the RDFa attributes in
            stead of the class attributes that drive microformats...</textual></para><para class="po-block e194 e194"><textual class="po-textual">This would work on this example but unless you are ready to reimplement a RDFa parser that wouldn't work with models that would express
            the same set of triples using different RDFa syntaxes: even supporting a different namespace prefix than "nhrefs" would require extra
            work.</textual></para><para class="po-block e195 e195"><textual class="po-textual">The best way to avoid these issues is to use a RDFa parser and, if you enjoy jQuery, </textual><link class="po-inline e196 e196" xlink:actuate="onRequest" xlink:href="http://code.google.com/p/rdfquery/" xlink:show="new" xlink:type="simple"><textual class="po-textual">Jeni Tennison's rdfQuery</textual></link><textual class="po-textual"> is definitely for you since it comes as a kind of
                jQuery add-on and shares its syntax.</textual></para><para class="po-block e197 e197"><textual class="po-textual">RdfQuery also borrows a lot from SPARQL and to get the nhrefs links with their sources, you can write:</textual></para><programlisting class="po-block e198 e198" xml:space="preserve"><textual class="po-textual">    var rdf = jQuery(document)
        .rdf()
        .prefix('nhrefs', 'http://nhrefs.org/')
        .where('?link a nhrefs:link')
        .where('?link nhrefs:source ?source');
</textual></programlisting><para class="po-block e199 e199"><textual class="po-textual">In RdfQuery like in SPARQL, query results are sets of resources and literals rather than triples. These resources and literals cannot be
            mapped back to DOM nodes in the (X)HTML document and you need to go back to the triples for that.</textual></para><para class="po-block e200 e200"><textual class="po-textual">In our case, the outer span element for the link is the element that carries the type information:</textual></para><programlisting class="po-block e201 e201" xml:space="preserve"><textual class="po-textual">&lt;span typeof="nhrefs:link"&gt;
...
&lt;/span&gt;</textual></programlisting><para class="po-block e202 e202"><textual class="po-textual">A triple directly generated by this element is:</textual></para><programlisting class="po-block e203 e203" xml:space="preserve"><textual class="po-textual">?link a nhrefs:link</textual></programlisting><para class="po-block e204 e204"><textual class="po-textual">And to get the span element (to hide it and prepend the dialog and replacement link), you can query this triple and use its source
            attribute:</textual></para><programlisting class="po-block e205 e205" xml:space="preserve"><textual class="po-textual">    rdf
        .each(function(){
            var span = jQuery(rdf.reset().where(this.link.value + ' a nhrefs:link').sources()[0][0].source);
            span.hide();
</textual></programlisting><para class="po-block e206 e206"><textual class="po-textual">After that, you can perform a sub query to find the arcs and create the dialog with the query results. The remaining of the function is
            straightforward and the complete code is:</textual></para><programlisting class="po-block e207 e207" xml:space="preserve"><textual class="po-textual">jQuery(document).ready(function() {

    var rdf = jQuery(document)
        .rdf()
        .prefix('nhrefs', 'http://nhrefs.org/')
        .where('?link a nhrefs:link')
        .where('?link nhrefs:source ?source');
    rdf
        .each(function(){
            var span = jQuery(rdf.reset().where(this.link.value + ' a nhrefs:link').sources()[0][0].source);
            span.hide();
            var link = jQuery(span.before('&lt;a href=""&gt;'+this.source.value+'&lt;/a&gt;')[0].previousSibling);
            var dialog = jQuery(span.before('&lt;div title="Links for &amp;quot;'+ this.source.value + '&amp;quot;"&gt;&lt;ul /&gt; &lt;/div&gt;')[0].previousSibling);
            var list = jQuery('ul', dialog);
            rdf
                .reset()
                .where(this.link.value + ' nhrefs:hasarc ?arc')
                .where('?arc nhrefs:title ?title')
                .where('?arc nhrefs:dest ?dest')
                .each(function(){
                    list.append('&lt;li&gt;&lt;a href="' + this.dest.value + '"&gt;' + this.title.value + '&lt;/a&gt;');
                });
            dialog.dialog({ autoOpen: false });
            link.click(function() {
                dialog.dialog("open");
                return false;
            }); 

            var x = this;
        });
});</textual></programlisting><para class="po-block e208 e208"><textual class="po-textual">Again, this code is more verbose than its microformat counterpart, but the links properties are accessed using proper queries over
            formal properties and that seems more robust than just relying on (X)HTML classes.</textual></para></section><section class="po-hcontainer e209 e209"><title class="po-block e210 e210"><textual class="po-textual">Bleeding with microdata</textual></title><para class="po-block e211 e211"><textual class="po-textual">HTML5's microdata is arguably the most bleeding edge of these somewhat competing technologies. Although HTML5 isn't there yet, microdata
                can be used with libraries such as </textual><link class="po-inline e212 e212" xlink:actuate="onRequest" xlink:href="http://gitorious.org/microdatajs" xlink:show="new" xlink:type="simple"><textual class="po-textual">HTML5 Microdata JavaScript</textual></link><textual class="po-textual">.</textual></para><para class="po-block e213 e213"><textual class="po-textual">Some HTML5 specific features such as using meta elements within page bodies can't be used (because these elements are considered bogus
            and are stripped down by browsers) and need to be workaround. However, the result is still reasonably simple:</textual></para><programlisting class="po-block e214 e214" xml:space="preserve"><textual class="po-textual">&lt;span itemscope="itemscope" itemtype="http://nhrefs.org/link"&gt;
    &lt;span itemprop="source"&gt;XQuery&lt;/span&gt; 
    [&lt;span itemscope="itemscope" itemprop="arc"&gt;
        &lt;a href="http://en.wikipedia.org/wiki/XQuery" itemprop="dest"&gt;
            &lt;span itemprop="title"&gt;XQuery on Wikipedia&lt;/span&gt;
        &lt;/a&gt; 
        &lt;a href="http://nhrefs.org/wikipedia" itemprop="role" &gt;&lt;/a&gt;
    &lt;/span&gt;, 
    &lt;span itemscope="itemscope" itemprop="arc"&gt;
        &lt;a href="http://www.w3.org/TR/xquery/" itemprop="dest"&gt;
            &lt;span itemprop="title"&gt;XQuery W3C Recommendation&lt;/span&gt;
        &lt;/a&gt;
        &lt;a href="http://nhrefs.org/authoritative" itemprop="role" &gt;&lt;/a&gt;
        &lt;!--&lt;meta itemprop="role" content="authoritative"/&gt;--&gt;
    &lt;/span&gt;]
&lt;/span&gt;</textual></programlisting><para class="po-block e215 e215"><textual class="po-textual">This code get displayed exactly like its microformat and RDFa counterparts when it is not processed by a script.</textual></para><para class="po-block e216 e216"><textual class="po-textual">The microdata jQuery library is fairly simple to use and the code to process these links is very similar to what we've seen so
            far:</textual></para><programlisting class="po-block e217 e217" xml:space="preserve"><textual class="po-textual">jQuery(document).ready(function() {

    jQuery(document)
        .items('http://nhrefs.org/link')
        .each(function(){
            var span = jQuery(this);
            span.hide();
            var source = span.properties('source').itemValue();
            var link = jQuery(span.before('&lt;a href=""&gt;'+ source +'&lt;/a&gt;')[0].previousSibling);
            var dialog = jQuery(span.before('&lt;div title="Links for &amp;quot;'+ source + '&amp;quot;"&gt;&lt;ul /&gt; &lt;/div&gt;')[0].previousSibling);
            var list = jQuery('ul', dialog);
            span
                .properties('arc')
                .each(function(){
                    var arc = jQuery(this);
                    list.append('&lt;li&gt;&lt;a href="' + arc.properties('dest').itemValue() + '"&gt;' + arc.properties('title').itemValue() + '&lt;/a&gt;');
                });
            dialog.dialog({ autoOpen: false });
            link.click(function() {
                dialog.dialog("open");
                return false;
            }); 
        });


});</textual></programlisting></section><section class="po-hcontainer e218 e218"><title class="po-block e219 e219"><textual class="po-textual">Why not extended XLinks after all?</textual></title><para class="po-block e220 e220"><textual class="po-textual">Now that we've seen the level of simplicity (or complexity) of three different approaches, let's go back and revisit extended XLinks.</textual></para><para class="po-block e221 e221"><textual class="po-textual">To express an extended link, you need to define :</textual><itemizedlist class="po-table e222 e222"><listitem class="po-container e223 e223"><para class="po-block e224 e224"><textual class="po-textual">The extended link itself that will serve as a container.</textual></para></listitem><listitem class="po-container e225 e225"><para class="po-block e226 e226"><textual class="po-textual">Link ends that can be either local to the link or external. In our case, the source (i.e. the span containing the text "XQuery") can be defined as a local resource and
                            the targets will necessarily be defined as external resources (aka XLink "locators").</textual></para></listitem><listitem class="po-container e227 e227"><para class="po-block e228 e228"><textual class="po-textual">The arcs between the link ends.</textual></para></listitem></itemizedlist></para><para class="po-block e229 e229"><textual class="po-textual">As far as XLink is concerned, a simple way to define these links in a XHTML document could be:</textual></para><programlisting class="po-block e230 e230" xml:space="preserve"><textual class="po-textual">&lt;!-- An extended link --&gt;
&lt;span xlink:type="extended" 
      xlink:role="http://nhrefs.org/link/"&gt;
   &lt;!-- Source (local resource) --&gt;
   &lt;span xlink:type="resource" 
         xlink:role="http://nhrefs.org/source/" 
         xlink:label="source"&gt;XQuery&lt;/span&gt;
   &lt;!-- Targets (remote resources aka locators) --&gt;
   &lt;span xlink:href="http://en.wikipedia.org/wiki/XQuery" 
         xlink:type="locator" 
         xlink:role="http://nhrefs.org/target/wikipedia/" 
         xlink:label="target" 
         xlink:title="XQuery on Wikipedia" &gt; &lt;/span&gt; 
   &lt;span xlink:href="http://www.w3.org/TR/xquery/" 
         xlink:type="locator" 
         xlink:role="http://nhrefs.org/target/authoritative/" 
         xlink:label="target" 
         xlink:title="XQuery W3C Recommendation"&gt; &lt;/span&gt;
   &lt;!-- Arcs --&gt;
   &lt;span xlink:type="arc" 
         xlink:from="source" 
         xlink:to="target"&gt; &lt;/span&gt;
&lt;/span&gt; </textual></programlisting><para class="po-block e231 e231"><textual class="po-textual">As far as I understand the XLink recommendation, this is enough to express what we want. That's not so bad and we could argue that the level of complexity is similar to what we've
                seen so far.</textual></para><para class="po-block e232 e232"><textual class="po-textual">Unfortunately, I am not aware of any existing implementation that can process this markup and display what we want to display. Browsers just ignore extended links and won't display
                anything more than the word "XQuery" from this markup.</textual></para><para class="po-block e233 e233"><textual class="po-textual">To get a degraded display similar to what we had with microformats, RDFa or microdata, we need to repeat the target titles and href attributes :</textual><programlisting class="po-block e234 e234" xml:space="preserve"><textual class="po-textual">&lt;!-- An extended link --&gt;
&lt;span xlink:type="extended" 
       xlink:role="http://nhrefs.org/link/"&gt;
  &lt;!-- The source --&gt;
  &lt;span xlink:type="resource" 
        xlink:role="http://nhrefs.org/source/" 
        xlink:label="source"&gt;XQuery&lt;/span&gt; [
  &lt;!-- The targets --&gt;
  &lt;a href="http://en.wikipedia.org/wiki/XQuery" 
     title="XQuery on Wikipedia"
     xlink:href="http://en.wikipedia.org/wiki/XQuery" 
     xlink:type="locator" 
     xlink:role="http://nhrefs.org/target/wikipedia/" 
     xlink:label="target" 
     xlink:title="XQuery on Wikipedia" &gt;XQuery on Wikipedia&lt;/a&gt;, 
  &lt;a href="http://www.w3.org/TR/xquery/" 
     title="XQuery W3C Recommendation"
     xlink:href="http://www.w3.org/TR/xquery/" 
     xlink:type="locator" 
     xlink:role="http://nhrefs.org/target/authoritative/" 
     xlink:label="target" 
     xlink:title="XQuery W3C Recommendation"&gt;XQuery W3C Recommendation&lt;/a&gt;]
  &lt;!-- The arcs --&gt;
  &lt;span xlink:type="arc" 
        xlink:from="source" 
        xlink:to="target"&gt; &lt;/span&gt;
&lt;/span&gt;</textual></programlisting><textual class="po-textual">
            </textual></para><para class="po-block e235 e235"><textual class="po-textual">Here we have a XHTML fragment that will get displayed with the degraded display than we have requested in our requirements and has the meaning that we want to convey for XLink
                implementations.</textual></para><para class="po-block e236 e236"><textual class="po-textual">The price to pay in term of complexity is clearly visible when we compare this fragment to what we've seen before. </textual></para><para class="po-block e237 e237"><textual class="po-textual">In addition to the markup complexity, I am not aware of any JavaScript implementation of extended XLinks on which we can rely to process this fragment like we did for the other
                technologies and we might have to develop our own JavaScript implementation</textual></para><para class="po-block e238 e238"><textual class="po-textual">If the downsides are clearly visible, the benefit is not that obvious!</textual></para><para class="po-block e239 e239"><textual class="po-textual">Except for being proud to be conform to a W3C recommendation and hoping to convince more people to use it, what's the benefit of using a recommendation that has almost no traction? </textual></para></section></section><section class="po-hcontainer e240 e240"><title class="po-block e241 e241"><textual class="po-textual">Next Step: Embedding</textual></title><para class="po-block e242 e242"><textual class="po-textual">A simple way to represent embedded links is to embed nhrefs links with the source property of another nhrefs link.</textual></para><para class="po-block e243 e243"><textual class="po-textual">OK, but how should we present such embedded links to the user?</textual></para><para class="po-block e244 e244"><textual class="po-textual">Taking back the example of "XML Prague", we could differentiate the link on "XML" that would present resources about XML and resources
            about XML Prague and the link on "Prague" that would present resources about Prague and resources about XML Prague. However, this would be
            displayed by the browser as one link (or at best two links separated by a space) and users would very likely miss the difference between
            these two links.</textual></para><para class="po-block e245 e245"><textual class="po-textual">To avoid this issue, I suggest that we display the same dialog on all the terms of embedded links. That dialog will display all the
            links for all the terms but can group the links per term.</textual></para><section class="po-hcontainer e246 e246"><title class="po-block e247 e247"><textual class="po-textual">Microformat</textual></title><para class="po-block e248 e248"><textual class="po-textual">Following these principles, the markup would be:</textual></para><programlisting class="po-block e249 e249" xml:space="preserve"><textual class="po-textual">&lt;span class="nhrefs"&gt;
    &lt;span class="source"&gt;
        &lt;span class="nhrefs"&gt;
            &lt;span class="source"&gt;XML&lt;/span&gt; 
            [
                &lt;a href="http://en.wikipedia.org/wiki/XML" class="arc" rel="wikipedia"&gt;XML on Wikipedia&lt;/a&gt;, 
                &lt;a href="http://www.w3.org/XML/" class="arc" rel="informative"&gt;W3C XML Home Page&lt;/a&gt;
                &lt;a href="http://www.w3.org/TR/REC-xml/" class="arc" rel="authoritative"&gt;XML 1.0 recommendation&lt;/a&gt;
            ]
        &lt;/span&gt;
        &lt;span class="nhrefs"&gt;
            &lt;span class="source"&gt;Prague&lt;/span&gt; 
            [
                &lt;a href="http://en.wikipedia.org/wiki/Prague" class="arc" rel="wikipedia"&gt;Prague on Wikipedia&lt;/a&gt;, 
                &lt;a href="http://wikitravel.org/en/Prague" class="arc" rel="informative"&gt;Prague travel guide on Wikitravel&lt;/a&gt;
            ]
        &lt;/span&gt;
    &lt;/span&gt; 
    [
        &lt;a href="http://www.xmlprague.cz/" class="arc" rel="authoritative"&gt;XML Prague&lt;/a&gt;, 
        &lt;a href="http://www.xmlprague.cz/2011/index.html" class="arc" rel="authoritative"&gt;XML Prague 2011&lt;/a&gt;
    ]
&lt;/span&gt;</textual></programlisting><para class="po-block e250 e250"><textual class="po-textual">I must admit that the result becomes much less readable when it not processed by a script and that some CSS might be used to improve
                that:</textual></para><figure class="po-container e251 e251"><title class="po-block e252 e252"><textual class="po-textual">Embedded nhrefs links not processed by a script</textual></title><mediaobject class="po-container e253 e253"><imageobject class="po-container e254 e254"><imagedata class="po-meta e255 e255" fileref="../../../vol7/graphics/Vlist01/Vlist01-005.png" format="png"><textual class="po-textual">Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao</textual></imagedata></imageobject></mediaobject><caption class="po-container e256 e256"><para class="po-block e257 e257"><textual class="po-textual">Snapshot of my blog using embedded links on XML, Prague end XML Prague.</textual></para></caption></figure><para class="po-block e258 e258"><textual class="po-textual">Of course things get better after being processed by an updated version of the script: </textual></para><figure class="po-container e259 e259"><title class="po-block e260 e260"><textual class="po-textual">Embedded nhrefs links processed by a script</textual></title><mediaobject class="po-container e261 e261"><imageobject class="po-container e262 e262"><imagedata class="po-meta e263 e263" fileref="../../../vol7/graphics/Vlist01/Vlist01-006.png" format="png"><textual class="po-textual">Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao Pippo! Ciao</textual></imagedata></imageobject></mediaobject><caption class="po-container e264 e264"><para class="po-block e265 e265"><textual class="po-textual">Snapshot of my blog using embedded links on XML, Prague end XML Prague after the links have been processed in
                        JavaScript.</textual></para><para class="po-block e266 e266"><textual class="po-textual">The script itself is now 68 lines long. Compared to the 24 lines it took previously we can say that supporting embedded
                        links has added a lot of complexity. Most of this complexity is due to the support of the grouping of the links. </textual></para><para class="po-block e267 e267"><textual class="po-textual">68 lines is too much code to copy into this paper,  however the size of the script is still very reasonable!</textual></para></caption></figure></section><section class="po-hcontainer e268 e268"><title class="po-block e269 e269"><textual class="po-textual">RDFa</textual></title><para class="po-block e270 e270"><textual class="po-textual">This can be ported to RDFa by creating bnodes as nhrefs:source that will themselves be nhrefs:links:</textual></para><programlisting class="po-block e271 e271" xml:space="preserve"><textual class="po-textual">&lt;span typeof="nhrefs:link"&gt;
    &lt;span rel="nhrefs:source"&gt;
        &lt;span typeof="nhrefs:link"&gt;
          &lt;span property="nhrefs:source"&gt;XML&lt;/span&gt; 
          &lt;span rel="nhrefs:hasarc"&gt;
              [&lt;span typeof="nhrefs:arc"&gt;
                  &lt;a href="http://en.wikipedia.org/wiki/XML" rel="nhrefs:dest" property="nhrefs:title"&gt;XML on Wikipedia&lt;/a&gt; 
                  &lt;span rel="nhrefs:role" resource="nhrefs:wikipedia" &gt;&lt;/span&gt;
              &lt;/span&gt;, 
              &lt;span typeof="nhrefs:arc"&gt;
                  &lt;a href="http://www.w3.org/XML/" rel="nhrefs:dest" property="nhrefs:title"&gt;W3C XML Home Page&lt;/a&gt;
                  &lt;span rel="nhrefs:role" resource="nhrefs:informative" &gt;&lt;/span&gt;
              &lt;/span&gt;,
              &lt;span typeof="nhrefs:arc"&gt;
                  &lt;a href="http://www.w3.org/TR/REC-xml/" rel="nhrefs:dest" property="nhrefs:title"&gt;XML 1.0 Recommendation&lt;/a&gt;
                  &lt;span rel="nhrefs:role" resource="nhrefs:authoritative" &gt;&lt;/span&gt;
              &lt;/span&gt;]
          &lt;/span&gt;
         &lt;/span&gt;
        &lt;span typeof="nhrefs:link"&gt;
            &lt;span property="nhrefs:source"&gt;Prague&lt;/span&gt; 
            &lt;span rel="nhrefs:hasarc"&gt;
                [&lt;span typeof="nhrefs:arc"&gt;
                    &lt;a href="http://en.wikipedia.org/wiki/Prague" rel="nhrefs:dest" property="nhrefs:title"&gt;Prague on Wikipedia&lt;/a&gt; 
                    &lt;span rel="nhrefs:role" resource="nhrefs:wikipedia" &gt;&lt;/span&gt;
                &lt;/span&gt;, 
                &lt;span typeof="nhrefs:arc"&gt;
                    &lt;a href="http://wikitravel.org/en/Prague" rel="nhrefs:dest" property="nhrefs:title"&gt;Prague travel guide on Wikitravel&lt;/a&gt;
                    &lt;span rel="nhrefs:role" resource="nhrefs:informative" &gt;&lt;/span&gt;
                &lt;/span&gt;]
            &lt;/span&gt;
        &lt;/span&gt;            
    &lt;/span&gt;
    &lt;span rel="nhrefs:hasarc"&gt;
        [&lt;span typeof="nhrefs:arc"&gt;
            &lt;a href="http://www.xmlprague.cz/" rel="nhrefs:dest" property="nhrefs:title"&gt;XML Prague&lt;/a&gt; 
            &lt;span rel="nhrefs:role" resource="nhrefs:authoritative" &gt;&lt;/span&gt;
        &lt;/span&gt;, 
        &lt;span typeof="typeof:arc"&gt;
            &lt;a href="http://www.xmlprague.cz/2011/index.html" rel="nhrefs:dest" property="nhrefs:title"&gt;XML Prague 2011&lt;/a&gt;
            &lt;span rel="nhrefs:role" resource="nhrefs:authoritative" &gt;&lt;/span&gt;
        &lt;/span&gt;]
    &lt;/span&gt;
&lt;/span&gt;</textual></programlisting><para class="po-block e272 e272"><textual class="po-textual">The model has now 41 triples and its graphical representation is hardly readable but its turtle representation is still readable: </textual></para><programlisting class="po-block e273 e273" xml:space="preserve"><textual class="po-textual">@prefix rdf: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt; .
@prefix : &lt;http://www.w3.org/1999/xhtml&gt; .
@prefix nhrefs: &lt;http://nhrefs.org/&gt; .

[]
    nhrefs:hasarc [
        nhrefs:dest &lt;http://www.xmlprague.cz/2011/index.html&gt; ;
        nhrefs:role &lt;nhrefs:authoritative&gt; ;
        nhrefs:title "XML Prague 2011"
    ], [
        nhrefs:dest &lt;http://www.xmlprague.cz/&gt; ;
        nhrefs:role &lt;nhrefs:authoritative&gt; ;
        nhrefs:title "XML Prague" ;
        a nhrefs:arc
    ] ;
    nhrefs:source [
        nhrefs:hasarc [
            nhrefs:dest &lt;http://en.wikipedia.org/wiki/XML&gt; ;
            nhrefs:role &lt;nhrefs:wikipedia&gt; ;
            nhrefs:title "XML on Wikipedia" ;
            a nhrefs:arc
        ], [
            nhrefs:dest &lt;http://www.w3.org/XML/&gt; ;
            nhrefs:role &lt;nhrefs:informative&gt; ;
            nhrefs:title "W3C XML Home Page" ;
            a nhrefs:arc
        ], [
            nhrefs:dest &lt;http://www.w3.org/TR/REC-xml/&gt; ;
            nhrefs:role &lt;nhrefs:authoritative&gt; ;
            nhrefs:title "XML 1.0 Recommendation" ;
            a nhrefs:arc
        ] ;
        nhrefs:source "XML" ;
        a nhrefs:link
    ], [
        nhrefs:hasarc [
            nhrefs:dest &lt;http://wikitravel.org/en/Prague&gt; ;
            nhrefs:role &lt;nhrefs:informative&gt; ;
            nhrefs:title "Prague travel guide on Wikitravel" ;
            a nhrefs:arc
        ], [
            nhrefs:dest &lt;http://en.wikipedia.org/wiki/Prague&gt; ;
            nhrefs:role &lt;nhrefs:wikipedia&gt; ;
            nhrefs:title "Prague on Wikipedia" ;
            a nhrefs:arc
        ] ;
        nhrefs:source "Prague" ;
        a nhrefs:link
    ] ;
    a nhrefs:link .
</textual></programlisting><para class="po-block e274 e274"><textual class="po-textual">Of course, we are bitten again by the same limitation: the links that compose sources are unordered and in theory there is no
                guarantee that when we generate the title for composed links we won't generate "Prague XML" instead of "XML Prague"!</textual></para><para class="po-block e275 e275"><textual class="po-textual">The JavaScript is 80 lines long (compared to 30).</textual></para></section><section class="po-hcontainer e276 e276"><title class="po-block e277 e277"><textual class="po-textual">Microdata</textual></title><para class="po-block e278 e278"><textual class="po-textual">This can be ported to microdata:</textual></para><programlisting class="po-block e279 e279" xml:space="preserve"><textual class="po-textual">&lt;html xmlns="http://www.w3.org/1999/xhtml" xmlns:nhrefs="http://nhrefs.org/"&gt;

&lt;span itemscope="itemscope" itemtype="http://nhrefs.org/link"&gt;
    &lt;span itemprop="source" itemscope="itemscope" itemtype="http://nhrefs.org/link"&gt;
        &lt;span itemprop="source"&gt;XML&lt;/span&gt; 
        [&lt;span itemscope="itemscope" itemprop="arc"&gt;
            &lt;a href="http://en.wikipedia.org/wiki/XML" itemprop="dest"&gt;
                &lt;span itemprop="title"&gt;XML on Wikipedia&lt;/span&gt;
            &lt;/a&gt; 
            &lt;a href="http://nhrefs.org/wikipedia" itemprop="role" &gt;&lt;/a&gt;
        &lt;/span&gt;, 
        &lt;span itemscope="itemscope" itemprop="arc"&gt;
            &lt;a href="http://www.w3.org/XML" itemprop="dest"&gt;
                &lt;span itemprop="title"&gt;W3C XML Home Page&lt;/span&gt;
            &lt;/a&gt;
            &lt;a href="http://nhrefs.org/informative" itemprop="role" &gt;&lt;/a&gt;
        &lt;/span&gt;,
        &lt;span itemscope="itemscope" itemprop="arc"&gt;
            &lt;a href="http://www.w3.org/TR/REC-xml/" itemprop="dest"&gt;
                &lt;span itemprop="title"&gt;XML W3C Recommendation&lt;/span&gt;
            &lt;/a&gt;
            &lt;a href="http://nhrefs.org/authoritative" itemprop="role" &gt;&lt;/a&gt;
        &lt;/span&gt;]
    &lt;/span&gt; 
    &lt;span itemprop="source" itemscope="itemscope" itemtype="http://nhrefs.org/link"&gt;
        &lt;span itemprop="source"&gt;Prague&lt;/span&gt; 
        [&lt;span itemscope="itemscope" itemprop="arc"&gt;
            &lt;a href="http://en.wikipedia.org/wiki/Prague" itemprop="dest"&gt;
                &lt;span itemprop="title"&gt;Prague on Wikipedia&lt;/span&gt;
            &lt;/a&gt; 
            &lt;a href="http://nhrefs.org/wikipedia" itemprop="role" &gt;&lt;/a&gt;
        &lt;/span&gt;, 
        &lt;span itemscope="itemscope" itemprop="arc"&gt;
            &lt;a href="hhttp://wikitravel.org/en/Prague" itemprop="dest"&gt;
                &lt;span itemprop="title"&gt;Prague travel guide on Wikitravel&lt;/span&gt;
            &lt;/a&gt;
            &lt;a href="http://nhrefs.org/informative" itemprop="role" &gt;&lt;/a&gt;
        &lt;/span&gt;]
    &lt;/span&gt; 
    [&lt;span itemscope="itemscope" itemprop="arc"&gt;
        &lt;a href="http://www.xmlprague.cz/" itemprop="dest"&gt;
            &lt;span itemprop="title"&gt;XML Prague&lt;/span&gt;
        &lt;/a&gt; 
        &lt;a href="http://nhrefs.org/authoritative" itemprop="role" &gt;&lt;/a&gt;
    &lt;/span&gt;, 
    &lt;span itemscope="itemscope" itemprop="arc"&gt;
        &lt;a href="http://www.xmlprague.cz/2011/index.html" itemprop="dest"&gt;
            &lt;span itemprop="title"&gt;XML Prague 2011&lt;/span&gt;
        &lt;/a&gt;
        &lt;a href="http://nhrefs.org/authoritative" itemprop="role" &gt;&lt;/a&gt;
    &lt;/span&gt;]
&lt;/span&gt;</textual></programlisting><para class="po-block e280 e280"><textual class="po-textual">The JavaScript is now 77 lines long (compared to 24).</textual></para></section></section><section class="po-hcontainer e281 e281"><title class="po-block e282 e282"><textual class="po-textual">Next Steps</textual></title><para class="po-block e283 e283"><textual class="po-textual">All three techniques provide a lightweight solution to express links with multiple arcs that are easy to parse in JavaScript. Now, what
            can we do with all these angle brackets?</textual></para><para class="po-block e284 e284"><textual class="po-textual">The first conclusion is that for this application there is no clear winner between microformats, RDFa and microdata:</textual></para><itemizedlist class="po-table e285 e285"><listitem class="po-container e286 e286"><para class="po-block e287 e287"><textual class="po-textual">Microformats are less verbose and more "free style". The price to pay is that you need to read the spec to understand the
                    structure of each of them and need to use DOM level methods to get your information.</textual></para></listitem><listitem class="po-container e288 e288"><para class="po-block e289 e289"><textual class="po-textual">Microdata and RDFa have roughly the same level of verbosity.</textual></para></listitem><listitem class="po-container e290 e290"><para class="po-block e291 e291"><textual class="po-textual">RDFa and microdata are more rigid and more verbose. The benefit is that if you use the right library you can parse their
                    structure with higher level methods.</textual></para></listitem><listitem class="po-container e292 e292"><para class="po-block e293 e293"><textual class="po-textual">In theory, RDFa doesn't preserve the relative order between arcs and multi part sources.</textual></para></listitem><listitem class="po-container e294 e294"><para class="po-block e295 e295"><textual class="po-textual">Microdata isn't at recommendation stage yet and may change.</textual></para></listitem><listitem class="po-container e296 e296"><para class="po-block e297 e297"><textual class="po-textual">With RDFa, it is straightforward to extract link information as triples and use semantic web tools to do all kind of funky
                    things with them.</textual></para></listitem><listitem class="po-container e298 e298"><para class="po-block e299 e299"><textual class="po-textual">In the future, microdata will probably be natively supported by browsers. </textual></para></listitem></itemizedlist><para class="po-block e300 e300"><textual class="po-textual">The most sensible choice is probably to make no choice and support all three technologies!</textual></para><para class="po-block e301 e301"><textual class="po-textual">OK, but what can we do with all these angle brackets?</textual></para><para class="po-block e302 e302"><textual class="po-textual">The markup should be further documented and it can be seen as an open API between:</textual></para><itemizedlist class="po-table e303 e303"><listitem class="po-container e304 e304"><para class="po-block e305 e305"><textual class="po-textual">Consumers (such as the scripts that have been presented here) that parse the markup to do all kind of interesting things.</textual></para></listitem><listitem class="po-container e306 e306"><para class="po-block e307 e307"><textual class="po-textual">Producers that write this markup which isn't really fun to write by hand.</textual></para></listitem></itemizedlist><para class="po-block e308 e308"><textual class="po-textual">The consumers that we've seen should be documented and tested before they can be considered really usable.</textual></para><para class="po-block e309 e309"><textual class="po-textual">Producers need to be implemented. Producers for popular web publishing platforms would be especially useful. For these platforms, two
            kind of publishers could be developed:</textual></para><itemizedlist class="po-table e310 e310"><listitem class="po-container e311 e311"><para class="po-block e312 e312"><textual class="po-textual">Transformers that transform other markup into one of these three formats. In WordPress for instance nhrefs links could be
                    expressed using </textual><link class="po-inline e313 e313" xlink:actuate="onRequest" xlink:href="http://codex.wordpress.org/Shortcode" xlink:show="new" xlink:type="simple"><textual class="po-textual">shortcodes</textual></link><textual class="po-textual"> in the posts.</textual></para></listitem><listitem class="po-container e314 e314"><para class="po-block e315 e315"><textual class="po-textual">GUI that let user create nhrefs links is a friendly way.</textual></para></listitem></itemizedlist><para class="po-block e316 e316"><textual class="po-textual">Producers and consumers could also be packaged as plug-ins for web publishing platforms. Such a plug-in would contain:</textual></para><itemizedlist class="po-table e317 e317"><listitem class="po-container e318 e318"><para class="po-block e319 e319"><textual class="po-textual">A producer to facilitate the production of nhrefs markup by the platform.</textual></para></listitem><listitem class="po-container e320 e320"><para class="po-block e321 e321"><textual class="po-textual">The JavaScript to display the links on the browser.</textual></para></listitem></itemizedlist><para class="po-block e322 e322"><textual class="po-textual">This is more or less my roadmap for this project. If you are interested, watch this space: </textual><link class="po-inline e323 e323" xlink:actuate="onRequest" xlink:href="http://nhrefs.org" xlink:show="new" xlink:type="simple"><textual class="po-textual">http://nhrefs.org</textual></link><textual class="po-textual">!</textual></para></section></article></classedDocument>